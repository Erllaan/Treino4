<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Trainer Partner</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            background-image: linear-gradient(135deg, #0d1117 0%, #171d2b 100%);
            font-size: 18px;
            padding: 20px;
        }

        .container {
            background: #161b22;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            width: 100%;
            max-width: 900px;
            box-sizing: border-box;
            border: 1px solid #30363d;
            margin-top: 20px;
        }

        h1 {
            text-align: center;
            color: #58a6ff;
            margin-bottom: 25px;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(88, 166, 255, 0.2);
            padding-bottom: 15px;
            border-bottom: 1px solid #30363d;
            font-size: 2.5em;
        }
        
        h2 {
            color: #58a6ff;
            margin-top: 30px;
            margin-bottom: 15px;
            font-weight: 600;
            font-size: 1.8em;
        }
        
        h3 {
             font-size: 1.5em;
             margin-bottom: 10px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 400;
            color: #8b949e;
        }

        input[type="text"],
        input[type="number"],
        select,
        .treino-container input[type="text"],
        .treino-container textarea {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #30363d;
            border-radius: 8px;
            background: #0d1117;
            color: #c9d1d9;
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-size: 1em;
        }
        
        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        .treino-container input[type="text"]:focus,
        .treino-container textarea:focus {
            border-color: #58a6ff;
            box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.3);
            outline: none;
        }
        
        input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        
        .treino-dia {
            border: 1px solid #30363d;
            background: #1c2128;
            padding: 25px;
            margin-bottom: 20px;
            border-radius: 12px;
            position: relative;
            transition: box-shadow 0.3s;
        }
        
        .treino-dia:hover {
            box-shadow: 0 0 15px rgba(88, 166, 255, 0.1);
        }
        
        .treino-dia.draggable:hover {
             cursor: grab;
        }

        .treino-dia h3 {
            margin-top: 0;
            color: #58a6ff;
            font-size: 1.5em;
            border-bottom: 1px solid #30363d;
            padding-bottom: 10px;
        }
        
        .treino-dia .remover {
            position: absolute;
            top: 15px;
            right: 15px;
            color: #f87171;
            font-weight: bold;
            cursor: pointer;
            font-size: 1.1em;
            transition: color 0.3s;
            border: none;
            background: transparent;
            padding: 5px;
        }
        
        .treino-dia .remover:hover {
            color: #dc2626;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .tecnicas-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            flex-basis: calc(33.333% - 15px);
            min-width: 150px;
        }
        
        .tecnicas-group .checkbox-item {
             flex-basis: calc(50% - 15px);
        }

        .checkbox-item label {
            font-weight: 300;
            font-size: 1em;
            color: #c9d1d9;
            margin-bottom: 0;
        }
        
        .form-section {
            background: #1c2128;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid #30363d;
        }

        .form-section h2 {
            border-bottom: 1px solid #30363d;
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: #58a6ff;
        }

        .add-dia, .btn-primary, .btn-secondary, .modal-footer button, .save-load-btn, .btn-menu {
            width: 100%;
            padding: 18px;
            font-size: 1.1em;
            font-weight: 600;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
            margin-top: 15px;
        }
        
        .add-dia {
            background-color: #58a6ff;
            box-shadow: 0 5px 15px rgba(88, 166, 255, 0.3);
        }

        .add-dia:hover {
            background-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(88, 166, 255, 0.4);
        }

        .btn-primary, .modal-footer button {
            background-color: #38c172;
            box-shadow: 0 5px 15px rgba(56, 193, 114, 0.3);
        }
        
        .btn-primary:hover, .modal-footer button:hover {
            background-color: #2b9e59;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(56, 193, 114, 0.4);
        }
        
        .btn-secondary, .btn-menu {
            background-color: #555;
            box-shadow: none;
            margin-bottom: 20px;
        }
        
        .btn-secondary:hover, .btn-menu:hover {
            background-color: #444;
            transform: translateY(-2px);
        }

        .btn-menu {
            background-color: #3b82f6;
        }

        .btn-menu:hover {
             background-color: #2563eb;
        }
        
        /* Estilo para os botões de Salvar e Carregar */
        .save-load-buttons {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        .save-load-buttons .save-load-btn {
            width: auto;
            flex-grow: 1;
            padding: 12px 20px;
            font-size: 1em;
            margin-top: 0;
        }
        .save-btn {
            background-color: #3b82f6;
        }
        .save-btn:hover {
            background-color: #2563eb;
        }
        .load-btn {
            background-color: #1a56db;
        }
        .load-btn:hover {
            background-color: #1e40af;
        }
        #treinosSalvosSelect {
            width: 100%;
            padding: 12px;
            margin-top: 10px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            color: #c9d1d9;
            font-size: 1em;
        }


        #treinoPreview {
            display: none;
            margin-top: 30px;
        }
        
        #treinoPreview .form-section {
            background: #1c2128;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid #30363d;
        }

        /* --- Estilos da Pré-Visualização (Melhorados) --- */
        .treino-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
            padding-bottom: 20px;
        }
        
        .treino-item {
            background: #161b22;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #30363d;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .treino-item:hover {
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
            transform: translateY(-2px);
        }
        /* Classe para destacar o item que está sendo arrastado */
        .treino-item.dragging {
            opacity: 0.5;
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        /* Classe para destacar o local de soltar o item */
        .treino-item.drag-over {
            border: 2px dashed #58a6ff;
            box-shadow: 0 0 10px rgba(88, 166, 255, 0.5);
        }

        .treino-item .remover {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #f87171;
            font-weight: bold;
            cursor: pointer;
            font-size: 1.1em;
            transition: color 0.3s;
            border: none;
            background: transparent;
            padding: 5px;
        }
        
        .treino-item .remover:hover {
            color: #dc2626;
        }
        
        .treino-item-header {
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #30363d;
        }
        
        .treino-item-header h4 {
            margin: 0;
            flex-grow: 1;
            color: #58a6ff;
            font-size: 1.3em;
            font-weight: 600;
        }

        .treino-item-header input[type="text"] {
            font-size: 1.3em;
            font-weight: 600;
            color: #c9d1d9;
            background: transparent;
            border: none;
            padding: 0;
            margin: 0;
        }
        
        .treino-item-body {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-end;
        }
        
        .treino-item-body .input-group {
            display: flex;
            flex-direction: column;
            flex-basis: 150px;
            flex-grow: 1;
        }

        .treino-item-body label {
            font-size: 0.9em;
            color: #8b949e;
            margin-bottom: 5px;
        }

        .treino-item-body input {
            padding: 10px;
            margin: 0;
            font-size: 1em;
            background: #0d1117;
        }
        
        .treino-item textarea {
            width: 100%;
            min-height: 80px;
            resize: vertical;
            padding: 10px;
            border: 1px solid #30363d;
            border-radius: 8px;
            background: #0d1117;
            color: #c9d1d9;
            font-size: 1em;
        }

        .treino-item .grip-handle {
            cursor: grab;
            display: flex;
            flex-direction: column;
            gap: 4px;
            padding: 5px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .treino-item .grip-handle:hover {
            opacity: 1;
        }

        .treino-item .grip-handle::before, .treino-item .grip-handle::after, .treino-item .grip-handle span {
            content: '';
            display: block;
            width: 20px;
            height: 2px;
            background: #8b949e;
            border-radius: 1px;
        }
        
        .adicionar-exercicio-btn {
            background-color: #58a6ff;
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 1em;
            border-radius: 8px;
            cursor: pointer;
            width: auto;
            margin-top: 10px;
            align-self: flex-start;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        .adicionar-exercicio-btn:hover {
            background-color: #3b82f6;
            transform: translateY(-1px);
        }
        
        .tecnica-info {
            font-size: 0.9em;
            font-style: italic;
            color: #8b949e;
            padding: 10px;
            border-left: 3px solid #58a6ff;
            margin-top: 10px;
            background: #11151a;
            border-radius: 4px;
        }
        
        /* Modal de sugestão de exercícios e confirmação */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #161b22;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            border: 1px solid #30363d;
        }

        .close-button {
            position: absolute;
            top: 15px;
            right: 15px;
            color: #8b949e;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .modal h3 {
             color: #c9d1d9;
             border-bottom: 1px solid #30363d;
             padding-bottom: 10px;
             margin-top: 0;
        }

        .exercicios-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .exercicio-sugestao {
            background: #1c2128;
            color: #c9d1d9;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
            text-align: center;
            font-weight: 500;
            border: 1px solid #30363d;
        }

        .exercicio-sugestao:hover {
            background-color: #3b82f6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .exercicio-sugestao.selected {
            background-color: #38c172;
            color: #fff;
            border-color: #38c172;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(56, 193, 114, 0.4);
        }

        .modal-footer {
            margin-top: 20px;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Botões de acessibilidade para subir/descer */
        .move-buttons {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-left: auto;
        }

        .move-buttons button {
            background: none;
            border: 1px solid #30363d;
            color: #8b949e;
            padding: 5px 8px;
            cursor: pointer;
            font-size: 1em;
            border-radius: 5px;
            transition: background-color 0.2s, color 0.2s;
        }

        .move-buttons button:hover {
            background-color: #30363d;
            color: #c9d1d9;
        }

        .move-buttons button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Estilo da notificação */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 15px 25px;
            border-radius: 8px;
            color: #fff;
            font-weight: 600;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s, visibility 0.5s;
        }
        .notification.show {
            opacity: 1;
            visibility: visible;
        }
        .notification.success {
            background-color: #38c172;
        }
        .notification.error {
            background-color: #f87171;
        }


        /* Media Queries para responsividade */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 2em;
            }
            .checkbox-item {
                flex-basis: calc(50% - 15px);
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.8em;
            }
            .checkbox-item {
                flex-basis: 100%;
            }
            .add-dia, .btn-primary, .btn-secondary, .modal-footer button {
                 font-size: 1em;
            }
            .treino-item-body {
                flex-direction: column;
                gap: 10px;
            }
            .treino-item-body .input-group {
                flex-basis: auto;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div id="notification" class="notification"></div>
    <div class="container">
        <h1>Your Trainer Partner</h1>

        <!-- TELA INICIAL -->
        <div id="telaInicial">
            <div class="form-section" style="text-align: center;">
                <h2>Bem-vindo!</h2>
                <p>O que gostaria de fazer?</p>
                <button type="button" class="btn-primary" onclick="iniciarNovoTreino()">Criar Novo Treino</button>
                <button type="button" class="btn-menu" onclick="mostrarTela('telaCarregar')">Carregar Treino Salvo</button>
            </div>
        </div>

        <!-- TELA DE CARREGAR TREINO -->
        <div id="telaCarregar" style="display: none;">
             <div class="form-section">
                 <div id="gerenciamentoTreinos">
                     <h3>Gerir Treinos Guardados</h3>
                     <select id="treinosSalvosSelect" size="5"></select>
                     <div class="save-load-buttons">
                         <button type="button" class="save-load-btn load-btn" onclick="carregarTreinoSelecionado()">Carregar</button>
                         <button type="button" class="save-load-btn" style="background-color: #6b7280;" onclick="renomearTreinoSelecionado()">Renomear</button>
                         <button type="button" class="save-load-btn" style="background-color: #ef4444;" onclick="deletarTreinoSelecionado()">Excluir</button>
                     </div>
                 </div>
                 <button type="button" class="btn-secondary" onclick="mostrarTela('telaInicial')">← Voltar ao Início</button>
             </div>
        </div>

        <!-- FORMULÁRIO DE CRIAÇÃO -->
        <form id="treinoForm" style="display: none;">
            <div id="formularioInicial">
                 <button type="button" class="btn-secondary" style="width: auto; padding: 10px 20px; margin-bottom: 20px;" onclick="mostrarTela('telaInicial')">← Voltar ao Início</button>
                <div class="form-section">
                    <h2>Informações do Aluno</h2>
                    <label for="nome_aluno">Nome do Aluno:</label>
                    <input type="text" id="nome_aluno" required>

                    <label for="dificuldade">Nível de Dificuldade:</label>
                    <select id="dificuldade" required>
                        <option value="Em Casa">Treino em Casa</option>
                        <option value="Iniciante">Iniciante</option>
                        <option value="Intermediario">Intermediario</option>
                        <option value="Avancado">Avançado</option>
                    </select>

                    <label for="objetivo">Objetivo do Treino:</label>
                    <select id="objetivo" required>
                        <option value="Emagrecimento">Emagrecimento</option>
                        <option value="Hipertrofia">Hipertrofia</option>
                        <option value="Condicionamento Físico Geral">Condicionamento Físico Geral</option>
                    </select>
                    
                    <input type="checkbox" id="incluir_descricao">
                    <label for="incluir_descricao" style="display:inline; font-weight:300;">Incluir descrições detalhadas dos exercícios</label>
                </div>

                <div class="form-section">
                    <h2>Análise Nutricional</h2>
                    <label for="peso">Peso (kg):</label>
                    <input type="number" id="peso" step="0.1" required>

                    <label for="altura">Altura (cm):</label>
                    <input type="number" id="altura" required>

                    <label for="idade">Idade:</label>
                    <input type="number" id="idade" required>
                    
                    <label for="sexo">Sexo:</label>
                    <select id="sexo" required>
                        <option value="Masculino">Masculino</option>
                        <option value="Feminino">Feminino</option>
                    </select>

                    <label for="fator_atividade">Nível de Atividade Física:</label>
                    <select id="fator_atividade" required>
                        <option value="1.2">Sedentário (pouco ou nenhum exercício)</option>
                        <option value="1.375">Levemente Ativo (exercício leve 1-3 dias/semana)</option>
                        <option value="1.55">Moderadamente Ativo (exercício moderado 3-5 dias/semana)</option>
                        <option value="1.725">Muito Ativo (exercício intenso 6-7 dias/semana)</option>
                        <option value="1.9">Extremamente Ativo (exercício muito intenso, 2x ao dia)</option>
                    </select>
                </div>
                
                <div id="diasDeTreino">
                    <h2>Planilha de Treino</h2>
                </div>
                
                <button type="button" class="add-dia" onclick="adicionarDiaTreino()">+ Adicionar Dia de Treino</button>
                <button type="button" class="btn-primary" onclick="gerarTreino()">Gerar Treino</button>
            </div>
        </form>
        
        <!-- TELA DE PRÉ-VISUALIZAÇÃO E EDIÇÃO -->
        <div id="treinoPreview" style="display: none;">
            <div class="form-section">
                <h2>Pré-visualização do Treino</h2>
                <div id="treinosPreviewContainer"></div>
                 <div id="gerenciamentoTreinosPreview" style="margin-top: 30px;">
                     <h3>Guardar Treino Atual</h3>
                     <label for="treinoNomeSalvo">Nome do Treino para Guardar:</label>
                     <input type="text" id="treinoNomeSalvo" placeholder="Ex: Treino de Força - Semana 1">
                     <div class="save-load-buttons">
                         <button type="button" class="save-load-btn save-btn" onclick="salvarTreino()">Guardar Treino</button>
                     </div>
                 </div>
                <button type="button" class="btn-secondary" onclick="voltarParaEditarFormulario()">← Editar Aluno / Treino</button>
                <button type="button" class="btn-primary" onclick="gerarPDFFinal()">Gerar PDF Final</button>
            </div>
        </div>
    </div>

    <!-- MODAL DE SUGESTÃO DE EXERCÍCIOS -->
    <div id="exercicioModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="fecharModal('exercicioModal')">&times;</span>
            <h3>Sugestões de Exercícios</h3>
            <div id="exerciciosList" class="exercicios-list">
                </div>
            <div class="modal-footer">
                <button onclick="adicionarExerciciosSelecionados()">Adicionar Selecionados</button>
            </div>
        </div>
    </div>

    <!-- NOVO: MODAL DE EXERCÍCIO PERSONALIZADO -->
    <div id="personalizadoModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="fecharModal('personalizadoModal')">&times;</span>
            <h3>Criar Exercício Personalizado</h3>
            <form id="formExercicioPersonalizado">
                <label for="nomeExercicioPersonalizado">Nome do Exercício:</label>
                <input type="text" id="nomeExercicioPersonalizado" required>

                <label for="grupoMuscularPersonalizado">Grupo Muscular:</label>
                <select id="grupoMuscularPersonalizado" required></select>

                <label for="repsExercicioPersonalizado">Séries/Reps:</label>
                <input type="text" id="repsExercicioPersonalizado" value="4x12" required>

                <label for="descansoExercicioPersonalizado">Descanso:</label>
                <input type="text" id="descansoExercicioPersonalizado" value="60-90s">

                <label for="descricaoExercicioPersonalizado">Descrição (opcional):</label>
                <textarea id="descricaoExercicioPersonalizado"></textarea>
            </form>
            <div class="modal-footer">
                <button onclick="adicionarExercicioPersonalizado()">Adicionar ao Treino</button>
            </div>
        </div>
    </div>

    <!-- NOVO MODAL DE CONFIRMAÇÃO -->
    <div id="confirmModal" class="modal">
        <div class="modal-content" style="max-width: 400px; max-height: auto;">
            <span class="close-button" onclick="fecharModal('confirmModal')">&times;</span>
            <h3 id="confirmModalTitle">Confirmar Ação</h3>
            <p id="confirmModalMessage" style="margin-top: 15px;"></p>
            <div class="modal-footer">
                <button id="confirmBtnCancel" class="btn-secondary" style="width: auto; padding: 12px 20px;">Cancelar</button>
                <button id="confirmBtnOk" class="btn-primary" style="width: auto; padding: 12px 20px;">Confirmar</button>
            </div>
        </div>
    </div>
    
    <script>
        const EXERCICIOS = [
    // --- PEITO ---
    {
        "id": 1, "nome": "Supino reto com barra", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Médio", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "Deite-se no banco reto, pés firmes no chão. Segure a barra com pegada um pouco mais aberta que a largura dos ombros, desça controlando até encostar levemente no peito e empurre até a extensão dos cotovelos."
    },
    {
        "id": 2, "nome": "Supino reto com halteres", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Médio", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "Deite-se no banco reto com um halter em cada mão, braços estendidos acima do peito. Abaixe controlando os halteres para os lados do corpo até a linha do peito e retorne à posição inicial."
    },
    {
        "id": 3, "nome": "Supino inclinado com barra", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Superior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra", "Banco Inclinado"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "No banco inclinado, segure a barra com pegada um pouco mais aberta que os ombros. Abaixe até a parte superior do peito e empurre para cima."
    },
    {
        "id": 4, "nome": "Supino inclinado com halteres", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Superior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Halteres", "Banco Inclinado"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "No banco inclinado, segure um halter em cada mão. Abaixe os halteres até a linha da parte superior do peito e empurre até estender os braços."
    },
    {
        "id": 5, "nome": "Supino declinado com barra", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Inferior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra", "Banco Declinado"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "No banco declinado, segure a barra com pegada um pouco mais aberta que os ombros. Desça controlando até a parte inferior do peito e empurre para cima."
    },
    {
        "id": 6, "nome": "Supino declinado com halteres", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Inferior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Halteres", "Banco Declinado"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "Deite-se no banco declinado, segure um halter em cada mão. Desça os halteres até a linha da parte inferior do peito e retorne à posição inicial."
    },
    {
        "id": 7, "nome": "Supino reto na máquina", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Médio", "estilo": "Press", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Sente-se na máquina, ajuste a altura do assento. Empurre as alavancas até estender completamente os braços e retorne devagar."
    },
    {
        "id": 8, "nome": "Supino inclinado na máquina", "grupoMuscular": "Peito", "grupoExercicio": "Supino", "subGrupo": "Superior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Sente-se no banco inclinado da máquina, empurre até estender os braços e retorne controlando."
    },
    {
        "id": 9, "nome": "Crucifixo reto com halteres", "grupoMuscular": "Peito", "grupoExercicio": "Crucifixo", "subGrupo": "Médio", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Deite-se no banco reto, braços estendidos acima do peito com os halteres próximos. Abra os braços lateralmente até sentir alongamento no peitoral e retorne."
    },
    {
        "id": 10, "nome": "Crucifixo inclinado com halteres", "grupoMuscular": "Peito", "grupoExercicio": "Crucifixo", "subGrupo": "Superior", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco Inclinado"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "No banco inclinado, braços estendidos acima do peito. Abra os braços lateralmente até sentir alongamento e volte fechando."
    },
    {
        "id": 11, "nome": "Crucifixo na polia baixa em pé", "grupoMuscular": "Peito", "grupoExercicio": "Crucifixo", "subGrupo": "Superior", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure as polias baixas, braços abertos. Puxe para frente, contraindo o peitoral, e retorne lentamente."
    },
    {
        "id": 12, "nome": "Crucifixo na polia alta em pé (crossover)", "grupoMuscular": "Peito", "grupoExercicio": "Crucifixo", "subGrupo": "Inferior", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure as polias altas, braços abertos. Puxe em direção à frente do corpo cruzando levemente as mãos e retorne controlando."
    },
    {
        "id": 13, "nome": "Peck deck (voador)", "grupoMuscular": "Peito", "grupoExercicio": "Crucifixo", "subGrupo": "Médio", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Sentado no aparelho, braços apoiados nas almofadas laterais. Feche os braços até unir à frente do corpo e retorne devagar."
    },
    {
        "id": 14, "nome": "Pullover com halteres", "grupoMuscular": "Peito", "grupoExercicio": "Pullover", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "3x12" },
        "descricao": "Deitado no banco, segure um halter com as duas mãos acima do peito. Desça lentamente o halter atrás da cabeça, mantendo braços levemente flexionados, e retorne."
    },
    {
        "id": 15, "nome": "Pullover com barra", "grupoMuscular": "Peito", "grupoExercicio": "Pullover", "estilo": "Isolador", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "3x12" },
        "descricao": "Deitado, segure barra acima do peito com braços estendidos. Abaixe controlando atrás da cabeça e volte."
    },
    {
        "id": 16, "nome": "Flexão de braço no solo", "grupoMuscular": "Peito", "grupoExercicio": "Flexão", "subGrupo": "Médio", "estilo": "Press", "tipo": "composto", "dificuldade": ["Iniciante", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3xMax", "Em Casa": "3xMax" },
        "descricao": "Mantenha mãos no chão alinhadas ao peito, corpo reto e abdômen firme. Desça flexionando cotovelos até quase tocar o chão e empurre de volta."
    },
    {
        "id": 17, "nome": "Flexão com pés elevados", "grupoMuscular": "Peito", "grupoExercicio": "Flexão", "subGrupo": "Superior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Peso Corporal", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Pés apoiados em banco ou elevação. Corpo reto, mãos no chão. Desça até quase encostar o peito no chão e suba."
    },
    {
        "id": 18, "nome": "Flexão com pegada fechada", "grupoMuscular": "Peito", "grupoExercicio": "Flexão", "subGrupo": "Médio", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Mãos próximas no centro do peito, corpo reto. Desça flexionando cotovelos e empurre até estender."
    },

    // --- COSTAS ---
    {
        "id": 19, "nome": "Puxada frontal aberta", "grupoMuscular": "Costas", "grupoExercicio": "Puxada", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Na polia alta, segure a barra com pegada aberta. Puxe até a frente do peito, cotovelos direcionados para baixo e ombros estabilizados. Retorne devagar."
    },
    {
        "id": 20, "nome": "Puxada frontal supinada", "grupoMuscular": "Costas", "grupoExercicio": "Puxada", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Na polia alta, segure a barra com pegada supinada (palmas voltadas para você). Puxe até a frente do peito, contraindo dorsais, e desça lentamente."
    },
    {
        "id": 21, "nome": "Puxada atrás da nuca", "grupoMuscular": "Costas", "grupoExercicio": "Puxada", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Avancado": "4x10" },
        "descricao": "Na polia alta, segure a barra com pegada aberta. Puxe a barra para trás da cabeça até a nuca, mantendo tronco firme, e retorne controlando."
    },
    {
        "id": 22, "nome": "Puxada neutra (triângulo)", "grupoMuscular": "Costas", "grupoExercicio": "Puxada", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Na polia alta, com pegada neutra (triângulo), puxe a barra em direção ao peito, mantendo cotovelos próximos ao corpo. Retorne devagar."
    },
    {
        "id": 23, "nome": "Remada curvada com barra", "grupoMuscular": "Costas", "grupoExercicio": "Remada", "estilo": "Puxada Horizontal", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Avancado": "4x8" },
        "descricao": "Segure a barra, tronco inclinado à frente, joelhos semiflexionados. Puxe a barra em direção ao abdômen, mantendo costas retas, e desça controlando."
    },
    {
        "id": 24, "nome": "Remada curvada com halteres", "grupoMuscular": "Costas", "grupoExercicio": "Remada", "estilo": "Puxada Horizontal", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure um halter em cada mão, tronco inclinado. Puxe os halteres em direção à lateral do abdômen, contraindo dorsais, e desça lentamente."
    },
    {
        "id": 25, "nome": "Remada unilateral com halter", "grupoMuscular": "Costas", "grupoExercicio": "Remada", "estilo": "Puxada Horizontal", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Iniciante": "3x12" },
        "descricao": "Apoie uma mão e joelho no banco, segure um halter com a outra mão. Puxe em direção ao quadril e retorne devagar, mantendo coluna neutra."
    },
    {
        "id": 26, "nome": "Remada baixa no cabo (triângulo)", "grupoMuscular": "Costas", "grupoExercicio": "Remada", "estilo": "Puxada Horizontal", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Sentado, segure o triângulo da polia baixa. Puxe em direção ao abdômen, contraindo dorsais, e retorne lentamente."
    },
    {
        "id": 27, "nome": "Barra fixa pronada", "grupoMuscular": "Costas", "grupoExercicio": "Barra Fixa", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Avancado", "Em Casa"], "equipamento": ["Barra Fixa"],
        "sugerirRepeticoes": { "Avancado": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Segure a barra com pegada pronada, mãos na largura dos ombros. Puxe o corpo até o queixo passar da barra, mantendo abdômen contraído, e desça controlando."
    },
    {
        "id": 28, "nome": "Chin-up (barra fixa supinada)", "grupoMuscular": "Costas", "grupoExercicio": "Barra Fixa", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Avancado", "Em Casa"], "equipamento": ["Barra Fixa"],
        "sugerirRepeticoes": { "Avancado": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Segure a barra com pegada supinada (palmas voltadas para você). Puxe o corpo até o queixo ultrapassar a barra e desça lentamente, mantendo tronco firme."
    },
    {
        "id": 29, "nome": "Inverted row (Remada australiana)", "grupoMuscular": "Costas", "grupoExercicio": "Remada", "estilo": "Puxada Horizontal", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Barra Baixa", "Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Deite-se sob uma barra fixa baixa ou TRX. Segure a barra com pegada pronada, corpo reto. Puxe o peito em direção à barra e desça controlando."
    },
    {
        "id": 30, "nome": "Pullover na polia alta com barra reta", "grupoMuscular": "Costas", "grupoExercicio": "Pullover", "estilo": "Puxada Vertical", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure a barra da polia alta, braços estendidos à frente. Puxe a barra mantendo os cotovelos levemente flexionados até a frente do corpo, e retorne controlando."
    },
    {
        "id": 31, "nome": "Superman", "grupoMuscular": "Costas", "grupoExercicio": "Extensão Lombar", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Iniciante", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3x15", "Em Casa": "3x15" },
        "descricao": "Deite de bruços, braços e pernas estendidos. Eleve braços e pernas simultaneamente, segure 2s e desça."
    },

    // --- QUADRÍCEPS ---
    {
        "id": 32, "nome": "Agachamento livre com barra nas costas", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x12", "Avancado": "5x10" },
        "descricao": "Com a barra apoiada sobre a parte superior das costas, flexione os joelhos até as coxas ficarem paralelas ao chão. Suba controlando, mantendo coluna ereta."
    },
    {
        "id": 33, "nome": "Agachamento frontal com barra", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Avancado": "4x10" },
        "descricao": "Barra apoiada na frente dos ombros. Flexione joelhos mantendo tronco ereto e suba contraindo quadríceps."
    },
    {
        "id": 34, "nome": "Agachamento com halteres ao lado do corpo", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Segure halteres ao lado do corpo. Flexione joelhos e agache mantendo tronco reto. Retorne."
    },
    {
        "id": 35, "nome": "Agachamento goblet com halter à frente", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Halteres", "Kettlebell"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Segure halter próximo ao peito. Flexione os joelhos e desça mantendo tronco reto. Suba contraindo quadríceps e glúteos."
    },
    {
        "id": 36, "nome": "Agachamento búlgaro com halteres", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Um pé apoiado em banco atrás, outro à frente. Desça flexionando a perna da frente até 90° e suba."
    },
    {
        "id": 37, "nome": "Afundo com barra", "grupoMuscular": "Quadríceps", "grupoExercicio": "Afundo", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Barra sobre os ombros. Dê passo à frente e flexione joelhos até 90°. Retorne empurrando o chão."
    },
    {
        "id": 38, "nome": "Afundo com halteres", "grupoMuscular": "Quadríceps", "grupoExercicio": "Afundo", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Halteres", "Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3x12", "Intermediario": "4x10", "Em Casa": "3x12" },
        "descricao": "Segure halteres, passo à frente. Flexione joelhos e suba."
    },
    {
        "id": 39, "nome": "Recuo (Reverse lunge)", "grupoMuscular": "Quadríceps", "grupoExercicio": "Afundo", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Halteres", "Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Em Casa": "3x12" },
        "descricao": "Segure halteres ao lado do corpo, dê um passo para trás. Flexione joelhos e suba controlando, alternando pernas."
    },
    {
        "id": 40, "nome": "Passada com barra", "grupoMuscular": "Quadríceps", "grupoExercicio": "Passada", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Com barra sobre ombros, dê passos longos à frente, flexionando joelhos até 90° e retorne."
    },
    {
        "id": 41, "nome": "Passada com halteres", "grupoMuscular": "Quadríceps", "grupoExercicio": "Passada", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Iniciante": "3x12" },
        "descricao": "Segure halteres, dê passos à frente, flexionando joelhos até 90°. Retorne."
    },
    {
        "id": 42, "nome": "Step-up com halteres", "grupoMuscular": "Quadríceps", "grupoExercicio": "Step-up", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Iniciante", "Em Casa"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Iniciante": "3x15", "Em Casa": "3x15" },
        "descricao": "Suba em banco ou caixa segurando halteres. Empurre pelo calcanhar e retorne."
    },
    {
        "id": 43, "nome": "Leg press 45°", "grupoMuscular": "Quadríceps", "grupoExercicio": "Leg Press", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Flexione joelhos na plataforma e estenda empurrando sem travar."
    },
    {
        "id": 44, "nome": "Agachamento no Smith", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Desça em agachamento mantendo postura ereta e suba controlando."
    },
    {
        "id": 45, "nome": "Agachamento Hack na máquina", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Desça flexionando joelhos, suba empurrando pés contra a plataforma."
    },
    {
        "id": 46, "nome": "Cadeira extensora", "grupoMuscular": "Quadríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Sente-se, estenda os joelhos até contrair quadríceps, retorne controlando."
    },
    {
        "id": 47, "nome": "Extensão de perna unilateral na polia", "grupoMuscular": "Quadríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Prenda tornozeleira à polia baixa, estenda a perna até contrair quadríceps, retorne controlando."
    },
    {
        "id": 48, "nome": "Levantamento terra sumô com barra", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "subGrupo": "Adutor", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Pés afastados, barra entre as pernas. Flexione quadris e joelhos, suba contraindo quadríceps e glúteos."
    },
    {
        "id": 49, "nome": "Levantamento terra sumô com halter", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "subGrupo": "Adutor", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Iniciante": "3x12" },
        "descricao": "Mesma execução com halter."
    },
    {
        "id": 50, "nome": "Cadeira adutora", "grupoMuscular": "Quadríceps", "grupoExercicio": "Adução", "subGrupo": "Adutor", "estilo": "Adução", "tipo": "isolador", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Feche pernas contra as almofadas da máquina, retorne devagar."
    },
    {
        "id": 51, "nome": "Sissy squat", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "isolador", "dificuldade": ["Avancado", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Avancado": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Em pé, corpo reto, flexione joelhos inclinando para trás, suba controlando."
    },
    {
        "id": 52, "nome": "Agachamento Zercher", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Avancado": "4x8" },
        "descricao": "Barra na dobra dos cotovelos. Desça e suba mantendo tronco ereto."
    },
    {
        "id": 53, "nome": "Pistol squat", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Avancado", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Avancado": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Agachamento unilateral sem apoio, mantendo perna oposta estendida à frente."
    },
    {
        "id": 54, "nome": "Wall Sit (Isometria)", "grupoMuscular": "Quadríceps", "grupoExercicio": "Agachamento", "estilo": "Isometria", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3x30s", "Intermediario": "3x60s", "Em Casa": "3x45s" },
        "descricao": "Encoste costas na parede, joelhos 90°, mantenha posição isométrica."
    },

    // --- POSTERIOR DE COXA (ISQUIOTIBIAIS) ---
    {
        "id": 55, "nome": "Stiff com barra", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Stiff", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure a barra à frente do corpo, pés na largura dos ombros. Flexione quadris levando barra próximo às pernas, mantendo joelhos levemente flexionados, e retorne contraindo posterior de coxa."
    },
    {
        "id": 56, "nome": "Stiff com halteres", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Stiff", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure um halter em cada mão à frente das coxas. Flexione quadris mantendo coluna reta, desça os halteres próximos às pernas e retorne."
    },
    {
        "id": 57, "nome": "Stiff unilateral", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Stiff", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Halteres", "Kettlebell"],
        "sugerirRepeticoes": { "Avancado": "4x10" },
        "descricao": "Segure um halter em uma mão. Apoie o outro pé em banco ou chão, flexione quadril da perna livre mantendo equilíbrio e retorne."
    },
    {
        "id": 58, "nome": "Levantamento terra romeno", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Levantamento Terra", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Avancado": "4x8" },
        "descricao": "Segure barra à frente do corpo. Desça controlando o tronco flexionando quadris, joelhos levemente flexionados, até alongar posterior e suba."
    },
    {
        "id": 59, "nome": "Levantamento terra unilateral com halter", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Levantamento Terra", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Avancado": "4x10" },
        "descricao": "Segure um halter, apoie a perna oposta levemente à frente. Flexione quadril da perna de apoio, desça e retorne controlando."
    },
    {
        "id": 60, "nome": "Mesa flexora deitado", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Flexão", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Deite-se na máquina, apoie tornozelos sob rolos. Flexione joelhos contra a resistência e retorne devagar."
    },
    {
        "id": 61, "nome": "Flexora sentada", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Flexão", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Sente-se na máquina, pés sob rolos. Flexione joelhos trazendo calcanhares para baixo, retorne devagar."
    },
    {
        "id": 62, "nome": "Flexora em pé (unilateral)", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Flexão", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Apoie um joelho na máquina, perna de trabalho na alavanca. Flexione joelho contra resistência e retorne."
    },
    {
        "id": 63, "nome": "Flexão de joelho com polia baixa e tornozeleira", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Flexão", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Prenda tornozeleira à polia baixa, flexione joelho puxando perna para trás, retorne devagar."
    },
    {
        "id": 64, "nome": "Nordic ham curl", "grupoMuscular": "Posterior de Coxa", "grupoExercicio": "Flexão", "estilo": "Flexão", "tipo": "composto", "dificuldade": ["Avancado", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Avancado": "4xMax", "Em Casa": "3xMax" },
        "descricao": "Apoie os tornozelos, joelhos no chão. Flexione tronco à frente mantendo costas retas até tocar o chão, retorne contraindo posterior."
    },

    // --- GLÚTEOS ---
    {
        "id": 65, "nome": "Elevação pélvica (hip thrust) com barra", "grupoMuscular": "Glúteo", "grupoExercicio": "Elevação Pélvica", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x12", "Avancado": "4x10" },
        "descricao": "Apoie ombros em banco, barra sobre quadris. Eleve quadris contraindo glúteos, formando linha reta joelhos-ombros, retorne."
    },
    {
        "id": 66, "nome": "Elevação pélvica com halter", "grupoMuscular": "Glúteo", "grupoExercicio": "Elevação Pélvica", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Mesma execução com halter sobre quadris."
    },
    {
        "id": 67, "nome": "Ponte de glúteo no solo", "grupoMuscular": "Glúteo", "grupoExercicio": "Elevação Pélvica", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Iniciante", "Em Casa"], "equipamento": ["Peso Corporal"], "sexoExclusivo": "Feminino",
        "sugerirRepeticoes": { "Iniciante": "3x20", "Em Casa": "3x20" },
        "descricao": "Deite de costas, pés no chão, eleve quadris contraindo glúteos e desça controlando."
    },
    {
        "id": 68, "nome": "Kickback com tornozeleira na polia", "grupoMuscular": "Glúteo", "grupoExercicio": "Extensão de Quadril", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"], "sexoExclusivo": "Feminino",
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Prenda tornozeleira à polia baixa. Mantendo joelhos semiflexionados, empurre perna para trás contra resistência e retorne."
    },
    {
        "id": 69, "nome": "Extensão de quadril na polia com perna estendida", "grupoMuscular": "Glúteo", "grupoExercicio": "Extensão de Quadril", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"], "sexoExclusivo": "Feminino",
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Prenda tornozeleira à polia. Com perna reta, estenda para trás e retorne controlando."
    },
    {
        "id": 70, "nome": "Glúteo com polia em 4 apoios", "grupoMuscular": "Glúteo", "grupoExercicio": "Extensão de Quadril", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"], "sexoExclusivo": "Feminino",
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Prenda tornozeleira à polia. Apoie mãos e joelhos, empurre perna contra resistência e retorne."
    },
    {
        "id": 71, "nome": "Máquina glúteo (extensão de quadril)", "grupoMuscular": "Glúteo", "grupoExercicio": "Extensão de Quadril", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15", "Intermediario": "4x12" },
        "descricao": "Sente-se na máquina, empurre a plataforma para trás contra resistência e retorne."
    },
    {
        "id": 72, "nome": "Agachamento sumô com barra", "grupoMuscular": "Glúteo", "grupoExercicio": "Agachamento", "subGrupo": "Adutor", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Pés afastados, barra entre as pernas. Agache mantendo tronco ereto e suba."
    },
    {
        "id": 73, "nome": "Agachamento sumô com halter entre as pernas", "grupoMuscular": "Glúteo", "grupoExercicio": "Agachamento", "subGrupo": "Adutor", "estilo": "Agachamento", "tipo": "composto", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Halteres", "Kettlebell"],
        "sugerirRepeticoes": { "Iniciante": "3x15", "Intermediario": "4x12", "Em Casa": "3x15" },
        "descricao": "Segure halter entre as pernas, pés afastados. Agache e suba controlando."
    },
    {
        "id": 74, "nome": "Agachamento lateral com halteres", "grupoMuscular": "Glúteo", "grupoExercicio": "Agachamento", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Dê passo lateral segurando halteres, flexione joelhos e retorne."
    },
    {
        "id": 75, "nome": "Passada no step", "grupoMuscular": "Glúteo", "grupoExercicio": "Step-up", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Banco", "Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4x12", "Em Casa": "3x15" },
        "descricao": "Suba no step, empurrando o calcanhar e contraindo glúteos, desça controlando."
    },
    {
        "id": 76, "nome": "Glute bridge com isometria", "grupoMuscular": "Glúteo", "grupoExercicio": "Elevação Pélvica", "estilo": "Isometria", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"], "sexoExclusivo": "Feminino",
        "sugerirRepeticoes": { "Iniciante": "3x30s", "Intermediario": "3x60s", "Em Casa": "3x45s" },
        "descricao": "Eleve quadris, contraia glúteos e mantenha posição por tempo determinado."
    },
    {
        "id": 77, "nome": "Agachamento com elástico ou isometria prolongada", "grupoMuscular": "Glúteo", "grupoExercicio": "Agachamento", "estilo": "Isometria", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Outros", "Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "3x60s", "Em Casa": "3x45s" },
        "descricao": "Com elástico acima dos joelhos, agache mantendo contração e postura, segure a posição."
    },
    {
        "id": 78, "nome": "Cadeira abdutora", "grupoMuscular": "Glúteo", "grupoExercicio": "Abdução", "estilo": "Abdução", "tipo": "isolador", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x20" },
        "descricao": "Apoie lateralmente as coxas, abra pernas contra resistência e retorne."
    },
    {
        "id": 79, "nome": "Abdução de perna na polia", "grupoMuscular": "Glúteo", "grupoExercicio": "Abdução", "estilo": "Abdução", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"], "sexoExclusivo": "Feminino",
        "sugerirRepeticoes": { "Intermediario": "4x15" },
        "descricao": "Prenda tornozeleira, afaste perna lateralmente contra resistência e retorne."
    },
    {
        "id": 80, "nome": "Recuo (reverse lunge)", "grupoMuscular": "Glúteo", "grupoExercicio": "Afundo", "estilo": "Lunge", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Halteres", "Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Em Casa": "3x12" },
        "descricao": "Dê passo para trás, flexione joelhos, retorne empurrando com perna da frente."
    },

    // --- OMBROS ---
    {
        "id": 81, "nome": "Desenvolvimento militar com barra", "grupoMuscular": "Ombro", "grupoExercicio": "Desenvolvimento", "subGrupo": "Anterior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10", "Avancado": "4x8" },
        "descricao": "Segure barra na frente dos ombros, cotovelos à frente. Empurre até estender braços acima da cabeça e retorne."
    },
    {
        "id": 82, "nome": "Desenvolvimento com halteres sentado", "grupoMuscular": "Ombro", "grupoExercicio": "Desenvolvimento", "subGrupo": "Anterior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure halteres próximos aos ombros, empurre acima da cabeça e retorne."
    },
    {
        "id": 83, "nome": "Desenvolvimento Arnold com halteres", "grupoMuscular": "Ombro", "grupoExercicio": "Desenvolvimento", "subGrupo": "Anterior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Comece com halteres à frente do peito, palmas voltadas para você. Suba girando os punhos até extensão total e retorne."
    },
    {
        "id": 84, "nome": "Desenvolvimento na máquina", "grupoMuscular": "Ombro", "grupoExercicio": "Desenvolvimento", "subGrupo": "Anterior", "estilo": "Press", "tipo": "composto", "dificuldade": ["Iniciante"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15" },
        "descricao": "Sente-se, empurre alavancas até estender braços e retorne devagar."
    },
    {
        "id": 85, "nome": "Elevação lateral com halteres", "grupoMuscular": "Ombro", "grupoExercicio": "Elevação", "subGrupo": "Lateral", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure halteres, braços ao lado. Eleve lateralmente até altura do ombro e desça."
    },
    {
        "id": 86, "nome": "Elevação lateral na polia baixa", "grupoMuscular": "Ombro", "grupoExercicio": "Elevação", "subGrupo": "Lateral", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure polia baixa, braço lateralmente. Eleve até altura do ombro e desça controlando."
    },
    {
        "id": 87, "nome": "Elevação frontal com halteres", "grupoMuscular": "Ombro", "grupoExercicio": "Elevação", "subGrupo": "Anterior", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure halteres, braços à frente. Eleve até altura dos ombros e desça."
    },
    {
        "id": 88, "nome": "Elevação frontal na polia com corda", "grupoMuscular": "Ombro", "grupoExercicio": "Elevação", "subGrupo": "Anterior", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure corda da polia baixa, braços à frente. Puxe para cima até altura do ombro e desça."
    },
    {
        "id": 89, "nome": "Crucifixo invertido com halteres", "grupoMuscular": "Ombro", "grupoExercicio": "Crucifixo Invertido", "subGrupo": "Posterior", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco Inclinado"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Deite-se inclinado, braços pendentes com halteres. Eleve lateralmente até alinhamento com ombros e retorne."
    },
    {
        "id": 90, "nome": "Crucifixo invertido na polia", "grupoMuscular": "Ombro", "grupoExercicio": "Crucifixo Invertido", "subGrupo": "Posterior", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure polias altas, braços à frente. Puxe lateralmente até abrir braços e retorne."
    },
    {
        "id": 91, "nome": "Crucifixo invertido na polia unilateral", "grupoMuscular": "Ombro", "grupoExercicio": "Crucifixo Invertido", "subGrupo": "Posterior", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure uma polia alta com uma mão de cada vez. Puxe lateralmente até o braço ficar paralelo ao chão, contraia ombro/posterior e retorne."
    },
    {
        "id": 92, "nome": "Posterior no peck-deck invertido", "grupoMuscular": "Ombro", "grupoExercicio": "Crucifixo Invertido", "subGrupo": "Posterior", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x15", "Intermediario": "4x12" },
        "descricao": "Sentado, braços apoiados, abra lateralmente contra resistência e retorne."
    },
    {
        "id": 93, "nome": "Encolhimento de ombros com barra", "grupoMuscular": "Trapézio", "grupoExercicio": "Encolhimento", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure a barra à frente do corpo ou atrás dos ombros, braços estendidos. Eleve os ombros em direção às orelhas, contraindo trapézio superior, e retorne devagar."
    },
    {
        "id": 94, "nome": "Encolhimento de ombros com halteres", "grupoMuscular": "Trapézio", "grupoExercicio": "Encolhimento", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure um halter em cada mão ao lado do corpo. Eleve os ombros em direção às orelhas e desça controlando."
    },
    {
        "id": 95, "nome": "Remada alta com barra", "grupoMuscular": "Ombro", "grupoExercicio": "Remada Alta", "subGrupo": "Lateral", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure barra, palmas para baixo. Puxe até altura do peito, cotovelos altos, retorne controlando."
    },
    {
        "id": 96, "nome": "Remada alta com halteres", "grupoMuscular": "Ombro", "grupoExercicio": "Remada Alta", "subGrupo": "Lateral", "estilo": "Puxada Vertical", "tipo": "composto", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure halteres, puxe lateralmente até altura do peito, cotovelos elevados, e desça."
    },
    {
        "id": 97, "nome": "Face pull com polia ou elástico", "grupoMuscular": "Ombro", "grupoExercicio": "Face Pull", "subGrupo": "Posterior", "estilo": "Puxada Horizontal", "tipo": "isolador", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Polia", "Outros"],
        "sugerirRepeticoes": { "Intermediario": "4x15", "Em Casa": "3x15" },
        "descricao": "Segure corda da polia na altura do rosto. Puxe em direção à face, cotovelos abertos, contraia trapézio médio e posterior e retorne."
    },
    {
        "id": 98, "nome": "Elevação lateral inclinada no banco", "grupoMuscular": "Ombro", "grupoExercicio": "Elevação", "subGrupo": "Lateral", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco Inclinado"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Deite-se de lado em banco inclinado, halter na mão de cima. Eleve lateralmente até altura do ombro e desça controlando."
    },

    // --- TRÍCEPS ---
    {
        "id": 99, "nome": "Tríceps testa com barra reta", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Deite-se no banco, segure barra com pegada fechada. Flexione cotovelos levando barra em direção à testa e estenda os braços controlando."
    },
    {
        "id": 100, "nome": "Tríceps testa com barra W (EZ)", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Mesma execução, usando barra EZ para maior conforto de punho."
    },
    {
        "id": 101, "nome": "Tríceps francês com halteres (duas mãos)", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure halter com as duas mãos acima da cabeça, braços estendidos. Flexione cotovelos atrás da cabeça e estenda."
    },
    {
        "id": 102, "nome": "Tríceps francês unilateral com halter", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure halter com uma mão acima da cabeça, flexione cotovelo e estenda controlando."
    },
    {
        "id": 103, "nome": "Tríceps coice com halteres", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x12", "Em Casa": "3x15" },
        "descricao": "Incline tronco à frente, cotovelo flexionado, empurre halter para trás até estender braço e retorne."
    },
    {
        "id": 104, "nome": "Tríceps com barra reta na polia", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Iniciante": "3x15", "Intermediario": "4x12" },
        "descricao": "Segure barra na polia alta, cotovelos próximos ao tronco. Empurre para baixo até estender braços e retorne."
    },
    {
        "id": 105, "nome": "Tríceps com corda na polia", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure corda da polia alta, cotovelos fixos. Empurre para baixo separando a corda no final do movimento e retorne."
    },
    {
        "id": 106, "nome": "Tríceps unilateral na polia", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure polia com uma mão, empurre para baixo estendendo o braço e retorne."
    },
    {
        "id": 107, "nome": "Tríceps testa com corda na polia", "grupoMuscular": "Tríceps", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure corda na polia alta, cotovelos fixos. Empurre para baixo separando corda e retorne."
    },
    {
        "id": 108, "nome": "Paralelas (dips)", "grupoMuscular": "Tríceps", "grupoExercicio": "Mergulho", "estilo": "Press", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Paralelas"],
        "sugerirRepeticoes": { "Intermediario": "4xMax", "Avancado": "4xMax" },
        "descricao": "Apoie mãos em barras paralelas, corpo reto ou levemente inclinado. Flexione cotovelos e suba estendendo braços."
    },
    {
        "id": 109, "nome": "Mergulho no banco", "grupoMuscular": "Tríceps", "grupoExercicio": "Mergulho", "estilo": "Press", "tipo": "composto", "dificuldade": ["Iniciante", "Em Casa"], "equipamento": ["Banco", "Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3xMax", "Em Casa": "3xMax" },
        "descricao": "Mãos apoiadas no banco, pernas estendidas à frente. Flexione cotovelos e empurre até estender."
    },

    // --- BÍCEPS ---
    {
        "id": 110, "nome": "Rosca direta com barra reta", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure barra com pegada supinada. Flexione cotovelos levando barra até os ombros e retorne controlando."
    },
    {
        "id": 111, "nome": "Rosca com barra W (EZ)", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Mesma execução com barra EZ para conforto de punhos."
    },
    {
        "id": 112, "nome": "Rosca concentrada com halteres", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Sente-se, cotovelo apoiado na coxa. Flexione braço levando halter ao ombro e retorne."
    },
    {
        "id": 113, "nome": "Rosca alternada com halteres", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Iniciante": "3x12", "Intermediario": "4x10", "Em Casa": "3x12" },
        "descricao": "Flexione um braço de cada vez, mantendo cotovelos próximos ao tronco, e retorne."
    },
    {
        "id": 114, "nome": "Rosca martelo com halteres", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Segure halteres com palmas voltadas uma para a outra. Flexione cotovelos sem girar punhos e retorne."
    },
    {
        "id": 115, "nome": "Rosca Scott (bilateral e unilateral)", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Máquina", "Barra", "Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Apoie braços no banco Scott. Flexione cotovelos levantando barra e retorne."
    },
    {
        "id": 116, "nome": "Rosca no banco inclinado com halteres", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres", "Banco Inclinado"],
        "sugerirRepeticoes": { "Intermediario": "4x10" },
        "descricao": "Sente-se em banco inclinado, braços estendidos. Flexione cotovelos levando halteres aos ombros e retorne."
    },
    {
        "id": 117, "nome": "Rosca direta na polia com barra", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure barra na polia baixa. Flexione cotovelos e retorne controlando."
    },
    {
        "id": 118, "nome": "Rosca unilateral na polia", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure polia baixa com uma mão, flexione cotovelo e retorne."
    },
    {
        "id": 119, "nome": "Rosca martelo na polia com corda", "grupoMuscular": "Bíceps", "grupoExercicio": "Rosca", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x12" },
        "descricao": "Segure corda, palmas voltadas uma para a outra. Flexione cotovelo e retorne."
    },

    // --- PANTURRILHAS ---
    {
        "id": 120, "nome": "Elevação de gêmeos em pé com barra", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Barra"],
        "sugerirRepeticoes": { "Intermediario": "4x15" },
        "descricao": "Segure barra sobre ombros, suba na ponta dos pés e desça controlando."
    },
    {
        "id": 121, "nome": "Elevação de gêmeos com halteres", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x15" },
        "descricao": "Segure halteres, suba na ponta dos pés e desça controlando."
    },
    {
        "id": 122, "nome": "Elevação de gêmeos na máquina em pé", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x20", "Intermediario": "4x15" },
        "descricao": "Posicione ombros na máquina, suba na ponta dos pés e desça devagar."
    },
    {
        "id": 123, "nome": "Elevação de gêmeos sentado com halter nos joelhos", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario"], "equipamento": ["Halteres", "Banco"],
        "sugerirRepeticoes": { "Iniciante": "3x20", "Intermediario": "4x15" },
        "descricao": "Sente-se, coloque halteres nos joelhos, suba na ponta dos pés e retorne."
    },
    {
        "id": 124, "nome": "Elevação de gêmeos na máquina sentada", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Iniciante", "Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Iniciante": "3x20", "Intermediario": "4x15" },
        "descricao": "Sente-se, ajuste carga, suba na ponta dos pés e desça controlando."
    },
    {
        "id": 125, "nome": "Panturrilha no leg press", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Máquina"],
        "sugerirRepeticoes": { "Intermediario": "4x15" },
        "descricao": "Pés na plataforma, empurre com as pontas dos pés, suba e desça controlando."
    },
    {
        "id": 126, "nome": "Elevação unilateral de panturrilha", "grupoMuscular": "Panturrilha", "grupoExercicio": "Elevação", "estilo": "Elevação", "tipo": "isolador", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4x15", "Em Casa": "3x15" },
        "descricao": "Em pé, suba em uma perna mantendo equilíbrio e retorne."
    },
    {
        "id": 127, "nome": "Pular corda", "grupoMuscular": "Panturrilha", "grupoExercicio": "Cardio", "estilo": "Cardio", "tipo": "composto", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Outros"],
        "sugerirRepeticoes": { "Iniciante": "3x60s", "Intermediario": "4x90s", "Em Casa": "3x60s" },
        "descricao": "Salte mantendo ritmo constante, abdômen firme e postura ereta."
    },

    // --- ABDÔMEN ---
    {
        "id": 128, "nome": "Abdominal crunch no solo", "grupoMuscular": "Core", "grupoExercicio": "Crunch", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Iniciante", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3x20", "Em Casa": "3x20" },
        "descricao": "Deite de costas, pés apoiados, mãos na cabeça ou peito. Flexione tronco até contrair abdômen e desça."
    },
    {
        "id": 129, "nome": "Abdominal infra com elevação de pernas", "grupoMuscular": "Core", "grupoExercicio": "Elevação de Pernas", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4x15", "Em Casa": "3x15" },
        "descricao": "Deite de costas, eleve pernas retas até 90°, retorne controlando."
    },
    {
        "id": 130, "nome": "Abdominal canivete", "grupoMuscular": "Core", "grupoExercicio": "Canivete", "estilo": "Flexão", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "3x15", "Avancado": "4x15" },
        "descricao": "Deite de costas, braços acima da cabeça. Eleve tronco e pernas simultaneamente até se encontrarem e retorne."
    },
    {
        "id": 131, "nome": "Abdominal oblíquo (torção lateral)", "grupoMuscular": "Core", "grupoExercicio": "Crunch", "estilo": "Rotação", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "4x20" },
        "descricao": "Deite de costas, mãos atrás da cabeça. Flexione tronco e gire ombro em direção ao joelho oposto, alternando lados."
    },
    {
        "id": 132, "nome": "Bicicleta no solo", "grupoMuscular": "Core", "grupoExercicio": "Bicicleta", "estilo": "Rotação", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "3x60s", "Em Casa": "3x60s" },
        "descricao": "Deite, pernas elevadas, simule pedalada alternando cotovelo ao joelho oposto."
    },
    {
        "id": 133, "nome": "Abdominal com roda (ab wheel)", "grupoMuscular": "Core", "grupoExercicio": "Extensão", "estilo": "Extensão", "tipo": "composto", "dificuldade": ["Avancado"], "equipamento": ["Outros"],
        "sugerirRepeticoes": { "Avancado": "4xMax" },
        "descricao": "Apoie mãos na roda, role para frente mantendo tronco reto e retorne."
    },
    {
        "id": 134, "nome": "Abdominal com halter no peito", "grupoMuscular": "Core", "grupoExercicio": "Crunch", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Halteres"],
        "sugerirRepeticoes": { "Intermediario": "4x15" },
        "descricao": "Segure halter no peito, faça crunches contraindo abdômen e retorne."
    },
    {
        "id": 135, "nome": "Abdominal na polia alta (cabo crunch)", "grupoMuscular": "Core", "grupoExercicio": "Crunch", "estilo": "Flexão", "tipo": "isolador", "dificuldade": ["Intermediario"], "equipamento": ["Polia"],
        "sugerirRepeticoes": { "Intermediario": "4x15" },
        "descricao": "Segure corda da polia alta, flexione tronco levando cotovelos aos joelhos e retorne."
    },
    {
        "id": 136, "nome": "Elevação de pernas na barra fixa", "grupoMuscular": "Core", "grupoExercicio": "Elevação de Pernas", "estilo": "Flexão", "tipo": "composto", "dificuldade": ["Intermediario", "Avancado"], "equipamento": ["Barra Fixa"],
        "sugerirRepeticoes": { "Intermediario": "3xMax", "Avancado": "4xMax" },
        "descricao": "Segure barra fixa, pernas estendidas. Eleve pernas até formar 90° com tronco e desça controlando."
    },
    {
        "id": 137, "nome": "Prancha", "grupoMuscular": "Core", "grupoExercicio": "Prancha", "estilo": "Isometria", "tipo": "composto", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3x30s", "Intermediario": "3x60s", "Em Casa": "3x45s" },
        "descricao": "Mantenha corpo reto, apoie antebraços e pés. Contraia abdômen e segure posição."
    },
    {
        "id": 138, "nome": "Prancha lateral", "grupoMuscular": "Core", "grupoExercicio": "Prancha", "estilo": "Isometria", "tipo": "composto", "dificuldade": ["Iniciante", "Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Iniciante": "3x30s", "Intermediario": "3x60s", "Em Casa": "3x45s" },
        "descricao": "Apoie antebraço e lateral do pé, corpo reto. Contraia abdômen e segure posição."
    },
    {
        "id": 139, "nome": "Prancha com elevação de braço/perna", "grupoMuscular": "Core", "grupoExercicio": "Prancha", "estilo": "Isometria", "tipo": "composto", "dificuldade": ["Intermediario", "Em Casa"], "equipamento": ["Peso Corporal"],
        "sugerirRepeticoes": { "Intermediario": "3x15", "Em Casa": "3x15" },
        "descricao": "Em posição de prancha, eleve braço ou perna alternadamente mantendo tronco estável."
    }
];

        const DICAS_GERAIS = [
            { titulo: "1. Alimentação e Hidratação", texto: "Consuma proteínas suficientes para a recuperação muscular e carboidratos para energia. Beba bastante água antes, durante e após o treino." },
            { titulo: "2. Descanso e Recuperação", texto: "Dormir de 7 a 9 horas por noite é crucial para a recuperação muscular e produção hormonal. O crescimento acontece durante o descanso, não apenas no treino." },
            { titulo: "3. Progressão de Carga", texto: "Aumente a carga ou o número de repetições gradualmente. O progresso contínuo é a chave para o seu desenvolvimento." },
            { titulo: "4. Execução e Conexão Mente-Músculo", texto: "Priorize a técnica perfeita em cada exercício. Sinta o músculo alvo contraindo e alongando para maximizar o estímulo." }
        ];

        const DICAS_POR_OBJETIVO = {
            "Hipertrofia": [
                { titulo: "Foco na Hipertrofia", texto: "Para ganhar massa muscular, priorize a carga. Trabalhe com pesos que permitam 8 a 12 repetições até a falha muscular, mantendo a forma correta." },
                { titulo: "Nutrição na Hipertrofia", texto: "A dieta é fundamental. Garanta um superávit calórico (consumir mais calorias do que gasta) e uma ingestão proteica elevada para sustentar o crescimento muscular." }
            ],
            "Emagrecimento": [
                { titulo: "Foco no Emagrecimento", texto: "Para perder peso, combine treinos de força com cardio. Aumente o volume de treino e a intensidade, e considere técnicas que elevam a frequência cardíaca, como supersets." },
                { titulo: "Nutrição no Emagrecimento", texto: "O déficit calórico é essencial. Consuma menos calorias do que gasta, mas sem comprometer a ingestão de proteínas e nutrientes essenciais." }
            ],
            "Condicionamento Físico Geral": [
                { titulo: "Foco no Condicionamento", texto: "Varie os estímulos. Alterne entre exercícios de força, resistência e cardio para desenvolver um corpo equilibrado e funcional." },
                { titulo: "Consistência é Chave", texto: "Mantenha a regularidade. Mesmo treinos mais curtos e menos intensos, se feitos consistentemente, trarão resultados duradouros." }
            ],
            "Em Casa": [
                { titulo: "Aproveite o peso do corpo", texto: "Ajuste o número de repetições ou a velocidade de execução (tempo sob tensão) para aumentar a intensidade. Use objetos de casa como carga." },
                { titulo: "Criatividade com o espaço", texto: "Seja criativo! Use cadeiras, toalhas, elásticos ou uma mochila com livros para simular diferentes equipamentos e variar os exercícios." }
            ]
        };

        const DESCRICOES_TECNICAS = {
            "Drop set": "Após a falha muscular em uma série, reduza imediatamente a carga e continue o exercício até a nova falha. Pode ser feito várias vezes.",
            "Rest-pause": "Faça uma série até a falha, descanse por um curto período (10-20 segundos), e continue com mais algumas repetições até a falha novamente. Repita 2-3 vezes.",
            "Superset": "Execute dois exercícios consecutivos para o mesmo grupo muscular (biset) ou para grupos musculares opostos (agonista-antagonista) sem descanso entre eles. EX: Supino Reto + Crucifixo Reto.",
            "Pré-Exaustão": "Realize um exercício isolador para o grupo muscular alvo até a falha, seguido imediatamente por um exercício composto que trabalhe o mesmo grupo. EX: Crucifixo Reto (isolador) + Supino Reto (composto).",
            "Pirâmide crescente": "Comece com mais repetições e menos peso, e em cada série subsequente, aumente o peso e diminua as repetições.",
            "Pirâmide decrescente": "Comece com menos repetições e mais peso, e em cada série subsequente, diminua o peso e aumente as repetições."
        };
        
        const TECNICAS_DISPONIVEIS = [
            "Superset", "Drop set", "Rest-pause", "Pré-Exaustão", "Pirâmide crescente", "Pirâmide decrescente"
        ];

        const LIMITES_TREINO_TOTAL = {
            "Em Casa": { min: 5, max: 7 },
            "Iniciante": { min: 5, max: 7 },
            "Intermediario": { min: 6, max: 8 },
            "Avancado": { min: 7, max: 9 }
        };

        const PESOS_GRUPOS = {
            1: 1.0, // Primeiro grupo principal
            2: 0.8, // Segundo grupo
            3: 0.5  // Terceiro e demais grupos
        };

        const GRUPOS_MUSCULARES_GRANDES = ["Peito", "Costas", "Quadríceps", "Glúteo", "Ombro"];

        const LIMITES_ACESSORIOS = { // Máximo de exercícios para grupos musculares "acessórios"
            "Panturrilha": 2,
            "Trapézio": 2,
            "Antebraço": 1,
            "Core": 2
        };

        const GRUPOS_ANISTAS_ANTAGONISTAS = {
            "Peito": "Costas",
            "Costas": "Peito",
            "Bíceps": "Tríceps",
            "Tríceps": "Bíceps",
            "Quadríceps": "Posterior de Coxa",
            "Posterior de Coxa": "Quadríceps"
        };
        
        const ESTILOS_COMPATIVEIS_SUPERSET = {
            "Press": ["Isolador", "Press"],
            "Puxada Vertical": ["Puxada Horizontal", "Isolador"],
            "Puxada Horizontal": ["Puxada Vertical", "Isolador"],
            "Agachamento": ["Isolador", "Lunge"],
            "Extensão": ["Isolador", "Agachamento"],
            "Abdução": ["Isolador"],
            "Flexão": ["Isolador", "Flexão"],
            "Rosca": ["Isolador", "Flexão"],
            "Isolador": ["Isolador", "Composto"]
        };

        // CORRIGIDO: Hierarquia de dificuldade para seleção de exercícios
        const DIFICULDADE_HIERARQUIA = {
            "Em Casa": ["Em Casa"],
            "Iniciante": ["Iniciante", "Intermediario", "Em Casa"],
            "Intermediario": ["Iniciante", "Intermediario", "Em Casa"],
            "Avancado": ["Iniciante", "Intermediario", "Avancado", "Em Casa"]
        };


        let gruposDisponiveis = [...new Set(EXERCICIOS.map(ex => ex.grupoMuscular))].sort();
        let diaTreinoCount = 0;
        let modalDiaIndex = null;
        
        /**
         * Objeto para gerir o estado da aplicação.
         * Contém os treinos gerados e os treinos guardados no localStorage.
         */
        const appState = {
            treinoSemanal: [],
            treinosSalvos: {}
        };
        
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // NOVO: Função inteligente para buscar séries/repetições
        function getRepsParaNivel(exercicio, dificuldade) {
            const reps = exercicio.sugerirRepeticoes;
            if (reps[dificuldade]) return reps[dificuldade];
            
            // Lógica de fallback baseada na hierarquia
            if (dificuldade === 'Avancado' && reps['Intermediario']) return reps['Intermediario'];
            if (dificuldade === 'Avancado' && reps['Iniciante']) return reps['Iniciante'];
            if (dificuldade === 'Intermediario' && reps['Iniciante']) return reps['Iniciante'];
            if (dificuldade === 'Iniciante' && reps['Intermediario']) return reps['Intermediario'];

            const firstAvailable = Object.values(reps)[0];
            return firstAvailable || '3x12'; // Fallback final
        }
        
        function sortGruposMuscularesParaSelecao(gruposSelecionados) {
            const gruposSemCore = gruposSelecionados.filter(g => g !== "Core");
            const corePresente = gruposSelecionados.includes("Core");

            const sortedGrupos = gruposSemCore.sort((a, b) => {
                const aGrande = GRUPOS_MUSCULARES_GRANDES.includes(a);
                const bGrande = GRUPOS_MUSCULARES_GRANDES.includes(b);

                if (aGrande && !bGrande) return -1;
                if (!aGrande && bGrande) return 1;
                return 0;
            });

            if (corePresente) {
                sortedGrupos.push("Core");
            }
            return sortedGrupos;
        }

        function adicionarDiaTreino() {
            diaTreinoCount++;
            const diasDeTreinoContainer = document.getElementById('diasDeTreino');
            const diaTreinoDiv = document.createElement('div');
            diaTreinoDiv.classList.add('treino-dia');
            
            const gruposMuscularesOrdenados = gruposDisponiveis.sort();

            const gruposParaCheckboxes = gruposMuscularesOrdenados.map(grupo => `
                <div class="checkbox-item">
                    <input type="checkbox" id="grupo_dia_${diaTreinoCount}_${grupo}" name="grupos_dia_${diaTreinoCount}" value="${grupo}">
                    <label for="grupo_dia_${diaTreinoCount}_${grupo}">${grupo}</label>
                </div>
            `).join('');
            
            const tecnicasParaCheckboxes = TECNICAS_DISPONIVEIS.map(tecnica => `
                <div class="checkbox-item">
                    <input type="checkbox" id="tecnica_dia_${diaTreinoCount}_${tecnica.replace(/\s/g, '_')}" name="tecnicas_dia_${diaTreinoCount}" value="${tecnica}">
                    <label for="tecnica_dia_${diaTreinoCount}_${tecnica.replace(/\s/g, '_')}">${tecnica}</label>
                </div>
            `).join('');

            diaTreinoDiv.innerHTML = `
                <h3>Treino Dia ${diaTreinoCount}</h3>
                <span class="remover" onclick="this.parentNode.remove(); reordenarNomesDosTreinosFormulario()">x Remover</span>
                <label for="nome_dia_${diaTreinoCount}">Nome do Treino (opcional):</label>
                <input type="text" id="nome_dia_${diaTreinoCount}" name="nome_dia_${diaTreinoCount}" placeholder="Ex: Treino A">
                <label>Grupos Musculares (selecione em ordem de prioridade):</label>
                <div class="checkbox-group">
                    ${gruposParaCheckboxes}
                </div>
                <div style="margin-top: 20px;">
                    <label>Técnicas Avançadas (selecione as desejadas, máx. 2):</label>
                    <div class="tecnicas-group">
                        ${tecnicasParaCheckboxes}
                    </div>
                </div>
            `;
            diasDeTreinoContainer.appendChild(diaTreinoDiv);
        }

        function reordenarNomesDosTreinosFormulario() {
            const dias = document.querySelectorAll('.treino-dia');
            dias.forEach((dia, index) => {
                const h3 = dia.querySelector('h3');
                h3.textContent = `Treino Dia ${index + 1}`;
            });
            diaTreinoCount = dias.length;
        }
        
        // CORRIGIDO: Lógica de seleção de exercícios com hierarquia
        function getExerciciosParaGrupo(grupo, dificuldade, sexo) {
            const niveisPermitidos = DIFICULDADE_HIERARQUIA[dificuldade] || [dificuldade];
            
            return EXERCICIOS.filter(ex => {
                const isNivelCorreto = ex.dificuldade.some(nivel => niveisPermitidos.includes(nivel));
                const isSexoCorreto = !ex.sexoExclusivo || ex.sexoExclusivo === sexo;

                if (dificuldade === 'Em Casa') {
                    return ex.grupoMuscular === grupo && ex.dificuldade.includes('Em Casa') && isSexoCorreto;
                } else {
                    const isApenasDeCasa = ex.dificuldade.length === 1 && ex.dificuldade[0] === 'Em Casa';
                    return ex.grupoMuscular === grupo && isNivelCorreto && !isApenasDeCasa && isSexoCorreto;
                }
            });
        }
        
        function gerarTreinoAutomatico(dificuldade, grupos_musculares_selecionados, tecnicasSelecionadas, sexo) {
            let exerciciosSelecionados = [];
            const limitesNivel = LIMITES_TREINO_TOTAL[dificuldade];
            
            let grupos_principais_sem_core = grupos_musculares_selecionados.filter(g => g !== "Core");
            const core_selecionado = grupos_musculares_selecionados.includes("Core");

            let grupos_musculares_ordenados = sortGruposMuscularesParaSelecao(grupos_principais_sem_core);
            
            let numTotalExercicios = Math.min(Math.max(grupos_musculares_ordenados.length * 2, limitesNivel.min), limitesNivel.max);
            
            const pesosAtivos = grupos_musculares_ordenados.map((_, index) => PESOS_GRUPOS[Math.min(index + 1, 3)] || PESOS_GRUPOS[3]);
            const somaPesos = pesosAtivos.reduce((a, b) => a + b, 0);

            const numExerciciosPorGrupo = {};
            grupos_musculares_ordenados.forEach((grupo, index) => {
                let num = Math.round((pesosAtivos[index] / somaPesos) * numTotalExercicios);
                numExerciciosPorGrupo[grupo] = num > 0 ? num : 1;
            });
            
            grupos_musculares_ordenados.forEach(grupo => {
                if (LIMITES_ACESSORIOS[grupo] && grupo !== "Core") {
                    numExerciciosPorGrupo[grupo] = Math.min(numExerciciosPorGrupo[grupo], LIMITES_ACESSORIOS[grupo]);
                }
            });

            let somaAtual = Object.values(numExerciciosPorGrupo).reduce((a, b) => a + b, 0);
            while (somaAtual > numTotalExercicios) {
                const grupoMaior = Object.keys(numExerciciosPorGrupo).reduce((a, b) => numExerciciosPorGrupo[a] > numExerciciosPorGrupo[b] ? a : b);
                if (numExerciciosPorGrupo[grupoMaior] > 1 && !LIMITES_ACESSORIOS[grupoMaior]) {
                    numExerciciosPorGrupo[grupoMaior]--;
                    somaAtual--;
                } else {
                    break;
                }
            }
            while (somaAtual < numTotalExercicios) {
                const grupoMenor = Object.keys(numExerciciosPorGrupo).reduce((a, b) => numExerciciosPorGrupo[a] < numExerciciosPorGrupo[b] ? a : b);
                if (!LIMITES_ACESSORIOS[grupoMenor] || numExerciciosPorGrupo[grupoMenor] < LIMITES_ACESSORIOS[grupoMenor]) {
                    numExerciciosPorGrupo[grupoMenor]++;
                    somaAtual++;
                } else {
                    const gruposParaAumentar = grupos_musculares_ordenados.filter(g => !LIMITES_ACESSORIOS[g] || numExerciciosPorGrupo[g] < LIMITES_ACESSORIOS[g]);
                    if (gruposParaAumentar.length > 0) {
                        numExerciciosPorGrupo[gruposParaAumentar[Math.floor(Math.random() * gruposParaAumentar.length)]]++;
                        somaAtual++;
                    } else {
                        break;
                    }
                }
            }

            let gruposDeExerciciosUsados = new Set();
            for (const grupo of grupos_musculares_ordenados) {
                const numParaAdicionar = numExerciciosPorGrupo[grupo];
                let exerciciosDoGrupo = getExerciciosParaGrupo(grupo, dificuldade, sexo);
                
                let exerciciosDisponiveis = exerciciosDoGrupo.filter(ex => 
                    !exerciciosSelecionados.some(selectedEx => selectedEx.nome === ex.nome) &&
                    (!ex.grupoExercicio || !gruposDeExerciciosUsados.has(ex.grupoExercicio))
                );
                
                shuffleArray(exerciciosDisponiveis);
                
                let subGruposUsados = new Set();
                let estilosUsados = new Set();
                let tempExerciciosAdicionados = [];

                for (const exercicio of exerciciosDisponiveis) {
                    const hasSubGroup = exercicio.subGrupo;
                    const hasEstilo = exercicio.estilo;

                    const isSubGroupNovel = hasSubGroup ? !subGruposUsados.has(exercicio.subGrupo) : true;
                    const isEstiloNovel = hasEstilo ? !estilosUsados.has(exercicio.estilo) : true;
                    
                    const isGrupoExercicioNovel = exercicio.grupoExercicio ? !gruposDeExerciciosUsados.has(exercicio.grupoExercicio) : true;

                    if (tempExerciciosAdicionados.length < numParaAdicionar && isSubGroupNovel && isEstiloNovel && isGrupoExercicioNovel) {
                        tempExerciciosAdicionados.push(exercicio);
                        if (hasSubGroup) subGruposUsados.add(exercicio.subGrupo);
                        if (hasEstilo) estilosUsados.add(exercicio.estilo);
                        if (exercicio.grupoExercicio) gruposDeExerciciosUsados.add(exercicio.grupoExercicio);
                    }
                }

                let restantes = exerciciosDisponiveis.filter(ex => 
                    !tempExerciciosAdicionados.some(tempEx => tempEx.nome === ex.nome)
                );
                shuffleArray(restantes);
                while (tempExerciciosAdicionados.length < numParaAdicionar && restantes.length > 0) {
                    const ex = restantes.shift();
                    if (!ex.grupoExercicio || !gruposDeExerciciosUsados.has(ex.grupoExercicio)) {
                        tempExerciciosAdicionados.push(ex);
                        if (ex.grupoExercicio) gruposDeExerciciosUsados.add(ex.grupoExercicio);
                    }
                }
                
                exerciciosSelecionados = exerciciosSelecionados.concat(tempExerciciosAdicionados);
            }
            
            if (core_selecionado) {
                const numCore = LIMITES_ACESSORIOS["Core"];
                let exerciciosCore = getExerciciosParaGrupo("Core", dificuldade, sexo);
                shuffleArray(exerciciosCore);
                exerciciosSelecionados = exerciciosSelecionados.concat(exerciciosCore.slice(0, numCore));
            }

            if (tecnicasSelecionadas && tecnicasSelecionadas.length > 0) {
                aplicarTecnicasAvancadas(exerciciosSelecionados, dificuldade, tecnicasSelecionadas);
            }

            const treinoPrincipal = exerciciosSelecionados.filter(ex => ex.grupoMuscular !== "Core");
            const treinoCore = exerciciosSelecionados.filter(ex => ex.grupoMuscular === "Core");

            treinoPrincipal.sort((a, b) => {
                return grupos_musculares_ordenados.indexOf(a.grupoMuscular) - grupos_musculares_ordenados.indexOf(b.grupoMuscular);
            });
            
            return treinoPrincipal.concat(treinoCore);
        }

        function aplicarTecnicasAvancadas(treino, dificuldade, tecnicasDesejadas) {
            let exerciciosComTecnicas = 0;
            const MAX_TECNICAS_POR_TREINO = 2;
            
            shuffleArray(tecnicasDesejadas);

            for (const tecnica of tecnicasDesejadas) {
                if (exerciciosComTecnicas >= MAX_TECNICAS_POR_TREINO) break;

                if (tecnica === "Superset") {
                    for (let i = 0; i < treino.length; i++) {
                        const ex1 = treino[i];
                        if (ex1.tecnica || ex1.grupoMuscular === "Core") continue;

                        for (let j = i + 1; j < treino.length; j++) {
                            const ex2 = treino[j];
                            if (ex2.tecnica || ex2.grupoMuscular === "Core") continue;

                            const isCompatible = (ex1.grupoMuscular === ex2.grupoMuscular) || (GRUPOS_ANISTAS_ANTAGONISTAS[ex1.grupoMuscular] === ex2.grupoMuscular);
                            if (isCompatible) {
                                ex1.tecnica = "Superset";
                                ex1.supersetCom = {
                                    nome: ex2.nome,
                                    grupoMuscular: ex2.grupoMuscular,
                                    sugerirRepeticoes: getRepsParaNivel(ex2, dificuldade)
                                };
                                treino.splice(j, 1);
                                exerciciosComTecnicas++;
                                break; 
                            }
                        }
                        if (ex1.tecnica === "Superset") break;
                    }
                } 
                else if (tecnica === "Pré-Exaustão") {
                    for (let i = 0; i < treino.length; i++) {
                        const isolador = treino[i];
                        if (isolador.tecnica || isolador.tipo !== "isolador" || isolador.grupoMuscular === "Core") continue;

                        for (let j = 0; j < treino.length; j++) {
                            if (i === j) continue;
                            const composto = treino[j];
                            if (composto.tecnica || composto.tipo !== "composto" || composto.grupoMuscular !== isolador.grupoMuscular) continue;
                            
                            isolador.tecnica = "Pré-Exaustão";
                            isolador.preExaustaoCom = {
                                nome: composto.nome,
                                grupoMuscular: composto.grupoMuscular,
                                sugerirRepeticoes: getRepsParaNivel(composto, dificuldade)
                            };
                            treino.splice(j, 1);
                            exerciciosComTecnicas++;
                            break;
                        }
                        if (isolador.tecnica === "Pré-Exaustão") break;
                    }
                }
                else {
                    const exerciciosDisponiveis = treino.filter(ex => !ex.tecnica && ex.grupoMuscular !== "Core");
                    if (exerciciosDisponiveis.length > 0) {
                        const exAleatorio = exerciciosDisponiveis[Math.floor(Math.random() * exerciciosDisponiveis.length)];
                        const indexEx = treino.findIndex(e => e.id === exAleatorio.id);

                        if (indexEx !== -1) {
                            treino[indexEx].tecnica = tecnica;
                             if (tecnica === "Drop set") {
                                treino[indexEx].observacaoTecnica = "Após a falha, reduza o peso e continue até a nova falha.";
                            } else if (tecnica === "Rest-pause") {
                                treino[indexEx].observacaoTecnica = "Após a falha, descanse 10-20s e faça mais repetições.";
                            }
                            exerciciosComTecnicas++;
                        }
                    }
                }
            }
        }


        function calcularIMC(peso, altura) {
            const alturaMetros = altura / 100;
            const imc = peso / (alturaMetros * alturaMetros);
            return imc.toFixed(2);
        }

        function getIMCClassificacao(imc) {
            if (imc < 18.5) return "Abaixo do peso";
            if (imc >= 18.5 && imc < 24.9) return "Peso normal";
            if (imc >= 25 && imc < 29.9) return "Sobrepeso";
            if (imc >= 30 && imc < 34.9) return "Obesidade Grau I";
            if (imc >= 35 && imc < 39.9) return "Obesidade Grau II";
            return "Obesidade Grau III";
        }
        
        function calcularPesoIdeal(altura) {
            const alturaMetros = altura / 100;
            const imcIdeal = 21.7; // Média de um IMC saudável (18.5 a 24.9)
            const pesoIdeal = imcIdeal * (alturaMetros * alturaMetros);
            return pesoIdeal.toFixed(2);
        }

        function calcularAguaRecomendada(peso) {
            return (peso * 35).toFixed(0);
        }

        function calcularTMB(peso, altura, idade, sexo, fator_atividade) {
            let tmb;
            if (sexo === "Masculino") {
                tmb = 10 * peso + 6.25 * altura - 5 * idade + 5;
            } else {
                tmb = 10 * peso + 6.25 * altura - 5 * idade - 161;
            }
            const consumoCalorico = tmb * fator_atividade;
            return {
                tmb: tmb.toFixed(2),
                consumo: consumoCalorico.toFixed(2)
            };
        }
        
        function gerarDicasPersonalizadas(objetivo) {
            const dicasPersonalizadas = [...DICAS_GERAIS];
            if (DICAS_POR_OBJETIVO[objetivo]) {
                dicasPersonalizadas.push(...DICAS_POR_OBJETIVO[objetivo]);
            }
            return dicasPersonalizadas;
        }

        function gerarPDFFinal() {
            const nome_aluno = document.getElementById('nome_aluno').value;
            const dificuldade = document.getElementById('dificuldade').value;
            const objetivo = document.getElementById('objetivo').value;
            const incluir_descricao = document.getElementById('incluir_descricao').checked;

            const peso = parseFloat(document.getElementById('peso').value);
            const altura = parseInt(document.getElementById('altura').value);
            const idade = parseInt(document.getElementById('idade').value);
            const sexo = document.getElementById('sexo').value;
            const fator_atividade = parseFloat(document.getElementById('fator_atividade').value);

            const imc = calcularIMC(peso, altura);
            const pesoIdeal = calcularPesoIdeal(altura);
            const aguaRecomendada = calcularAguaRecomendada(peso);
            const { tmb, consumo } = calcularTMB(peso, altura, idade, sexo, fator_atividade);

            const dadosNutricionais = { imc, tmb, consumo, pesoIdeal, aguaRecomendada };
            const dadosGerais = { nome_aluno, dificuldade, objetivo };

            const treinoSemanalFinal = [];
            const diasPreview = document.querySelectorAll('.treino-preview-dia');
            
            diasPreview.forEach(diaDiv => {
                const nome_dia = diaDiv.querySelector('h3').textContent;
                const grupos_musculares = diaDiv.querySelector('p').textContent.replace('Grupos: ', '').split(', ');
                const exerciciosDoDia = [];
                const exercicioDivs = diaDiv.querySelectorAll('.treino-item');
                exercicioDivs.forEach(exDiv => {
                    const nome = exDiv.querySelector('.exercicio-nome').textContent;
                    const reps = exDiv.querySelector('.exercicio-reps').value;
                    const descanso = exDiv.querySelector('.exercicio-descanso').value;
                    const descricao = exDiv.querySelector('.exercicio-descricao').value;
                    const grupoMuscular = exDiv.dataset.grupoMuscular;

                    const exercicioAtual = { nome, grupoMuscular, sugerirRepeticoes: {}, descanso, descricao };
                    exercicioAtual.sugerirRepeticoes[dificuldade] = reps;
                    
                    const tecnicaInfo = exDiv.querySelector('.tecnica-info');
                    if(tecnicaInfo) {
                        const tecnica = tecnicaInfo.textContent.match(/Técnica: (.+)/)?.[1];
                        if (tecnica) exercicioAtual.tecnica = tecnica;
                    }

                    exerciciosDoDia.push(exercicioAtual);
                });
                treinoSemanalFinal.push({ nome_dia, grupos_musculares: grupos_musculares, treino: exerciciosDoDia });
            });

            gerarPdfTreinoSemanal(treinoSemanalFinal, dadosGerais, incluir_descricao, dadosNutricionais);
        }

        function gerarTreino() {
            const form = document.getElementById('treinoForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const nome_aluno = document.getElementById('nome_aluno').value;
            const dificuldade = document.getElementById('dificuldade').value;
            const objetivo = document.getElementById('objetivo').value;
            const sexo = document.getElementById('sexo').value;
            
            const diasTreino = document.querySelectorAll('.treino-dia');
            appState.treinoSemanal = [];

            if (diasTreino.length === 0) {
                showNotification("Por favor, adicione pelo menos um dia de treino.", "error");
                return;
            }

            let formularioValido = true;
            diasTreino.forEach((dia, index) => {
                let nomeDia = dia.querySelector('input[name^="nome_dia_"]').value;
                if (!nomeDia) {
                    nomeDia = `Treino ${String.fromCharCode(65 + index)}`;
                }

                const gruposMusculares = Array.from(dia.querySelectorAll('input[name^="grupos_dia_"]:checked'))
                                                 .map(checkbox => checkbox.value);
                
                if (gruposMusculares.length === 0) {
                    showNotification(`Por favor, selecione pelo menos um grupo muscular para o treino "${nomeDia}".`, "error");
                    formularioValido = false;
                    return;
                }

                const tecnicasSelecionadas = Array.from(dia.querySelectorAll('input[name^="tecnicas_dia_"]:checked'))
                                                      .map(checkbox => checkbox.value);
                
                if (tecnicasSelecionadas.length > 2) {
                    showNotification(`No treino "${nomeDia}", você selecionou ${tecnicasSelecionadas.length} técnicas. Por favor, selecione no máximo 2 técnicas por treino.`, "error");
                    formularioValido = false;
                    return;
                }

                const treinoDoDia = gerarTreinoAutomatico(dificuldade, gruposMusculares, tecnicasSelecionadas, sexo);
                
                appState.treinoSemanal.push({
                    nome_dia: nomeDia,
                    grupos_musculares: gruposMusculares,
                    tecnicas_selecionadas: tecnicasSelecionadas,
                    treino: treinoDoDia
                });
            });

            if (!formularioValido) {
                return;
            }
            
            renderizarPreview(appState.treinoSemanal);
            mostrarTela('treinoPreview');
        }

        function renderizarPreview(treinoSemanal) {
            const container = document.getElementById('treinosPreviewContainer');
            container.innerHTML = '';

            treinoSemanal.forEach((dia, diaIndex) => {
                const diaDiv = document.createElement('div');
                diaDiv.classList.add('treino-dia', 'treino-preview-dia');
                
                let gruposFormatados = dia.grupos_musculares.join(', ');
                if (gruposFormatados.length > 80) { // Limita o tamanho do texto no preview para não quebrar o layout
                    gruposFormatados = gruposFormatados.substring(0, 80) + '...';
                }

                const nomeTreino = dia.nome_dia.startsWith('Treino Dia ') ? `Treino Dia ${diaIndex + 1}` : dia.nome_dia;
                
                diaDiv.innerHTML = `
                    <h3>${nomeTreino}</h3>
                    <p><strong>Grupos:</strong> ${gruposFormatados}</p>
                    <div class="treino-container" id="treino-dia-${diaIndex}" ondragover="allowDrop(event)" ondrop="drop(event, ${diaIndex})"></div>
                `;
                container.appendChild(diaDiv);

                const treinoContainer = diaDiv.querySelector('.treino-container');
                dia.treino.forEach((exercicio, exercicioIndex) => {
                    renderizarExercicio(exercicio, treinoContainer, diaIndex, exercicioIndex);
                });
                
                const buttonContainer = document.createElement('div');
                buttonContainer.style.display = 'flex';
                buttonContainer.style.gap = '10px';
                buttonContainer.style.marginTop = '10px';

                const addBtn = document.createElement('button');
                addBtn.className = 'adicionar-exercicio-btn';
                addBtn.textContent = '+ Adicionar Exercício';
                addBtn.onclick = () => abrirModalExercicios(diaIndex);

                const customBtn = document.createElement('button');
                customBtn.className = 'adicionar-exercicio-btn';
                customBtn.style.backgroundColor = '#6b7280';
                customBtn.textContent = 'Criar Personalizado';
                customBtn.onclick = () => abrirModalExercicioPersonalizado(diaIndex);

                buttonContainer.appendChild(addBtn);
                buttonContainer.appendChild(customBtn);
                treinoContainer.appendChild(buttonContainer);
            });
        }
        
        function renderizarExercicio(exercicio, container, diaIndex, exercicioIndex) {
            const exercicioDiv = document.createElement('div');
            exercicioDiv.classList.add('treino-item');
            exercicioDiv.setAttribute('draggable', true);
            exercicioDiv.dataset.diaIndex = diaIndex;
            exercicioDiv.dataset.exercicioIndex = exercicioIndex;
            exercicioDiv.dataset.grupoMuscular = exercicio.grupoMuscular;

            exercicioDiv.ondragstart = (event) => drag(event, diaIndex, exercicioIndex);
            exercicioDiv.ondragenter = (event) => { event.target.closest('.treino-item')?.classList.add('drag-over'); };
            exercicioDiv.ondragleave = (event) => { event.target.closest('.treino-item')?.classList.remove('drag-over'); };
            exercicioDiv.ondragend = (event) => {
                const items = document.querySelectorAll('.treino-item');
                items.forEach(item => item.classList.remove('dragging', 'drag-over'));
            };

            let tecnicasHTML = '';
            if (exercicio.tecnica) {
                const descricaoTecnica = DESCRICOES_TECNICAS[exercicio.tecnica] || '';
                let detalhesTecnica = `<small>${descricaoTecnica}</small>`;

                if (exercicio.supersetCom) {
                    detalhesTecnica += `<br><strong>↳ com: ${exercicio.supersetCom.nome} (${exercicio.supersetCom.sugerirRepeticoes})</strong>`;
                } else if (exercicio.preExaustaoCom) {
                    detalhesTecnica += `<br><strong>↳ seguido de: ${exercicio.preExaustaoCom.nome} (${exercicio.preExaustaoCom.sugerirRepeticoes})</strong>`;
                } else if (exercicio.observacaoTecnica) {
                    detalhesTecnica += `<br><strong>↳ Instrução: ${exercicio.observacaoTecnica}</strong>`;
                }

                tecnicasHTML = `
                    <p class="tecnica-info">
                        Técnica: ${exercicio.tecnica}<br>
                        ${detalhesTecnica}
                    </p>
                `;
            }

            const tecnicasOptions = TECNICAS_DISPONIVEIS.map(t => `<option value="${t}" ${exercicio.tecnica === t ? 'selected' : ''}>${t}</option>`).join('');

            exercicioDiv.innerHTML = `
                <button class="remover" onclick="removerExercicio(${diaIndex}, ${exercicioIndex})">x</button>
                <div class="treino-item-header">
                    <span class="grip-handle"><span></span><span></span><span></span></span>
                    <h4><span class="exercicio-nome">${exercicio.nome}</span></h4>
                    <div class="move-buttons">
                        <button type="button" aria-label="Mover exercício para cima" onclick="moverExercicioParaCima(${diaIndex}, ${exercicioIndex})" ${exercicioIndex === 0 ? 'disabled' : ''}>▲</button>
                        <button type="button" aria-label="Mover exercício para baixo" onclick="moverExercicioParaBaixo(${diaIndex}, ${exercicioIndex})" ${appState.treinoSemanal[diaIndex].treino.length - 1 === exercicioIndex ? 'disabled' : ''}>▼</button>
                    </div>
                </div>
                <div class="treino-item-body">
                    <div class="input-group">
                        <label>Séries/Reps:</label>
                        <input type="text" class="exercicio-reps" value="${getRepsParaNivel(exercicio, document.getElementById('dificuldade').value)}" placeholder="Ex: 3x12">
                    </div>
                    <div class="input-group">
                        <label>Descanso:</label>
                        <input type="text" class="exercicio-descanso" value="${exercicio.descanso || '60-90s'}" placeholder="Ex: 60-90s">
                    </div>
                </div>
                <div>
                    <label for="tecnica-${diaIndex}-${exercicioIndex}">Técnica Manual:</label>
                    <select id="tecnica-${diaIndex}-${exercicioIndex}" onchange="atualizarTecnica(${diaIndex}, ${exercicioIndex}, this)">
                        <option value="Nenhuma" ${!exercicio.tecnica ? 'selected' : ''}>Nenhuma</option>
                        ${tecnicasOptions}
                    </select>
                </div>
                <div>
                    <label>Descrição:</label>
                    <textarea class="exercicio-descricao" placeholder="Descrição opcional">${exercicio.descricao || ''}</textarea>
                </div>
                ${tecnicasHTML}
            `;
            container.appendChild(exercicioDiv);
            
            const nomeSpan = exercicioDiv.querySelector('.exercicio-nome');
            nomeSpan.onclick = () => {
                const nomeAtual = nomeSpan.textContent;
                const input = document.createElement('input');
                input.type = 'text';
                input.value = nomeAtual;
                input.classList.add('exercicio-nome');
                input.onblur = () => {
                    nomeSpan.textContent = input.value;
                    nomeSpan.style.display = 'inline';
                    input.remove();
                };
                input.onkeydown = (e) => {
                    if (e.key === 'Enter') {
                        input.blur();
                    }
                };
                nomeSpan.style.display = 'none';
                nomeSpan.parentNode.appendChild(input);
                input.focus();
            };
        }
        
        function abrirModalExercicios(diaIndex) {
            modalDiaIndex = diaIndex;
            const diaDeTreino = appState.treinoSemanal[diaIndex];
            const gruposDoDia = diaDeTreino.grupos_musculares;
            const dificuldade = document.getElementById('dificuldade').value;
            const sexo = document.getElementById('sexo').value;

            let exerciciosFiltrados = [];
            gruposDoDia.forEach(grupo => {
                exerciciosFiltrados.push(...getExerciciosParaGrupo(grupo, dificuldade, sexo));
            });
            
            const exerciciosListDiv = document.getElementById('exerciciosList');
            exerciciosListDiv.innerHTML = '';
            
            const uniqueExercicios = [...new Map(exerciciosFiltrados.map(item => [item['id'], item])).values()];

            uniqueExercicios.forEach(ex => {
                const sugestaoDiv = document.createElement('div');
                sugestaoDiv.classList.add('exercicio-sugestao');
                sugestaoDiv.textContent = `${ex.nome} (${ex.grupoMuscular})`;
                sugestaoDiv.onclick = () => sugestaoDiv.classList.toggle('selected');
                exerciciosListDiv.appendChild(sugestaoDiv);
            });
            
            document.getElementById('exercicioModal').style.display = 'flex';
        }

        function adicionarExerciciosSelecionados() {
            if (modalDiaIndex === null) return;

            const selectedExercises = document.querySelectorAll('.exercicio-sugestao.selected');
            const dificuldade = document.getElementById('dificuldade').value;

            selectedExercises.forEach(el => {
                const nomeExercicio = el.textContent.split(' (')[0];
                const exercicioOriginal = EXERCICIOS.find(ex => ex.nome === nomeExercicio);

                if (exercicioOriginal) {
                    const novoExercicio = {
                        ...exercicioOriginal,
                        descanso: "60-90s"
                    };
                    appState.treinoSemanal[modalDiaIndex].treino.push(novoExercicio);
                }
            });

            renderizarPreview(appState.treinoSemanal);
            fecharModal('exercicioModal');
        }

        function fecharModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            if (modalId === 'exercicioModal') {
                const selectedExercises = document.querySelectorAll('.exercicio-sugestao.selected');
                selectedExercises.forEach(el => el.classList.remove('selected'));
            }
        }

        function abrirModalExercicioPersonalizado(diaIndex) {
            modalDiaIndex = diaIndex;
            const form = document.getElementById('formExercicioPersonalizado');
            form.reset();

            const selectGrupo = document.getElementById('grupoMuscularPersonalizado');
            selectGrupo.innerHTML = '';
            const gruposDoDia = appState.treinoSemanal[diaIndex].grupos_musculares;
            gruposDoDia.forEach(grupo => {
                const option = document.createElement('option');
                option.value = grupo;
                option.textContent = grupo;
                selectGrupo.appendChild(option);
            });

            document.getElementById('personalizadoModal').style.display = 'flex';
        }

        function adicionarExercicioPersonalizado() {
            const nome = document.getElementById('nomeExercicioPersonalizado').value;
            if (!nome || nome.trim() === "") {
                showNotification('O nome do exercício é obrigatório.', 'error');
                return;
            }

            const dificuldade = document.getElementById('dificuldade').value;
            const novoExercicio = {
                id: Date.now(),
                nome: nome,
                grupoMuscular: document.getElementById('grupoMuscularPersonalizado').value,
                sugerirRepeticoes: { [dificuldade]: document.getElementById('repsExercicioPersonalizado').value || 'N/A' },
                descanso: document.getElementById('descansoExercicioPersonalizado').value || '60-90s',
                descricao: document.getElementById('descricaoExercicioPersonalizado').value,
                tipo: 'composto',
                estilo: 'N/A',
                equipamento: ['Outros']
            };

            appState.treinoSemanal[modalDiaIndex].treino.push(novoExercicio);
            renderizarPreview(appState.treinoSemanal);
            fecharModal('personalizadoModal');
            showNotification(`Exercício "${nome}" adicionado com sucesso!`);
        }
        
        function moverExercicioParaCima(diaIndex, exercicioIndex) {
            if (exercicioIndex > 0) {
                const treinoDoDia = appState.treinoSemanal[diaIndex].treino;
                [treinoDoDia[exercicioIndex], treinoDoDia[exercicioIndex - 1]] = [treinoDoDia[exercicioIndex - 1], treinoDoDia[exercicioIndex]];
                renderizarPreview(appState.treinoSemanal);
            }
        }

        function moverExercicioParaBaixo(diaIndex, exercicioIndex) {
            const treinoDoDia = appState.treinoSemanal[diaIndex].treino;
            if (exercicioIndex < treinoDoDia.length - 1) {
                [treinoDoDia[exercicioIndex], treinoDoDia[exercicioIndex + 1]] = [treinoDoDia[exercicioIndex + 1], treinoDoDia[exercicioIndex]];
                renderizarPreview(appState.treinoSemanal);
            }
        }
        
        function removerExercicio(diaIndex, exercicioIndex) {
            if (appState.treinoSemanal[diaIndex] && appState.treinoSemanal[diaIndex].treino[exercicioIndex]) {
                 appState.treinoSemanal[diaIndex].treino.splice(exercicioIndex, 1);
            }
            reordenarNomesDosTreinos();
            renderizarPreview(appState.treinoSemanal);
        }

        function reordenarNomesDosTreinos() {
            appState.treinoSemanal.forEach((dia, index) => {
                dia.nome_dia = `Treino Dia ${index + 1}`;
            });
        }

        function voltarParaFormulario() {
            document.getElementById('formularioInicial').style.display = 'block';
            document.getElementById('treinoPreview').style.display = 'none';
        }

        function drag(event, diaIndex, exercicioIndex) {
            event.dataTransfer.setData("text/plain", JSON.stringify({ diaIndex, exercicioIndex }));
            setTimeout(() => {
                event.target.classList.add('dragging');
            }, 0);
        }

        function allowDrop(event) {
            event.preventDefault();
            const targetElement = event.target.closest('.treino-item');
            if (targetElement && !targetElement.classList.contains('drag-over')) {
                const items = document.querySelectorAll('.treino-item.drag-over');
                items.forEach(item => item.classList.remove('drag-over'));
                targetElement.classList.add('drag-over');
            }
        }
        
        function drop(event, targetDiaIndex) {
            event.preventDefault();
            const data = JSON.parse(event.dataTransfer.getData("text/plain"));
            const { diaIndex: sourceDiaIndex, exercicioIndex: sourceExercicioIndex } = data;
            
            const sourceItem = appState.treinoSemanal[sourceDiaIndex].treino[sourceExercicioIndex];
            
            let targetElement = event.target.closest('.treino-item');
            let targetIndex;
            
            if (targetElement) {
                targetIndex = Array.from(targetElement.parentNode.children).indexOf(targetElement);
            } else {
                targetIndex = appState.treinoSemanal[targetDiaIndex].treino.length;
                if (event.target.classList.contains('adicionar-exercicio-btn')) {
                    targetIndex--;
                }
            }
            
            const [movedItem] = appState.treinoSemanal[sourceDiaIndex].treino.splice(sourceExercicioIndex, 1);
            
            if (sourceDiaIndex === targetDiaIndex && targetIndex > sourceExercicioIndex) {
                targetIndex--;
            }
            appState.treinoSemanal[targetDiaIndex].treino.splice(targetIndex, 0, movedItem);

            reordenarNomesDosTreinos();
            renderizarPreview(appState.treinoSemanal);
        }

        function salvarTreino() {
            const treinoNomeSalvo = document.getElementById('treinoNomeSalvo').value;
            if (!treinoNomeSalvo) {
                showNotification('Por favor, dê um nome ao treino para o guardar.', 'error');
                return;
            }

            const alunoInfo = {
                nome_aluno: document.getElementById('nome_aluno').value,
                dificuldade: document.getElementById('dificuldade').value,
                objetivo: document.getElementById('objetivo').value,
                incluir_descricao: document.getElementById('incluir_descricao').checked,
                peso: document.getElementById('peso').value,
                altura: document.getElementById('altura').value,
                idade: document.getElementById('idade').value,
                sexo: document.getElementById('sexo').value,
                fator_atividade: document.getElementById('fator_atividade').value,
            };

            const treinoParaSalvar = {
                alunoInfo: alunoInfo,
                treinoSemanal: appState.treinoSemanal
            };

            if (appState.treinosSalvos[treinoNomeSalvo]) {
                showConfirm(
                    `Já existe um treino com o nome "${treinoNomeSalvo}". Deseja substituí-lo?`,
                    () => {
                        appState.treinosSalvos[treinoNomeSalvo] = treinoParaSalvar;
                        localStorage.setItem('treinosSalvos', JSON.stringify(appState.treinosSalvos));
                        showNotification(`Treino "${treinoNomeSalvo}" atualizado com sucesso!`);
                        carregarTreinosSalvos();
                    }
                );
            } else {
                appState.treinosSalvos[treinoNomeSalvo] = treinoParaSalvar;
                localStorage.setItem('treinosSalvos', JSON.stringify(appState.treinosSalvos));
                showNotification(`Treino "${treinoNomeSalvo}" guardado com sucesso!`);
                carregarTreinosSalvos();
            }
        }

        function carregarTreinosSalvos() {
            const treinosSalvos = localStorage.getItem('treinosSalvos');
            if (treinosSalvos) {
                appState.treinosSalvos = JSON.parse(treinosSalvos);
                const selectElement = document.getElementById('treinosSalvosSelect');
                selectElement.innerHTML = '';
                if (Object.keys(appState.treinosSalvos).length === 0) {
                    selectElement.innerHTML = '<option disabled>Nenhum treino guardado</option>';
                } else {
                    for (const nome in appState.treinosSalvos) {
                        const option = document.createElement('option');
                        option.value = nome;
                        option.textContent = nome;
                        selectElement.appendChild(option);
                    }
                }
            }
        }

        function carregarTreinoSelecionado() {
            const selectElement = document.getElementById('treinosSalvosSelect');
            const nomeSelecionado = selectElement.value;
            if (!nomeSelecionado) {
                showNotification('Por favor, selecione um treino para carregar.', 'error');
                return;
            }

            const treinoCarregado = appState.treinosSalvos[nomeSelecionado];
            if (treinoCarregado) {
                const { alunoInfo, treinoSemanal } = treinoCarregado;
                document.getElementById('nome_aluno').value = alunoInfo.nome_aluno;
                document.getElementById('dificuldade').value = alunoInfo.dificuldade;
                document.getElementById('objetivo').value = alunoInfo.objetivo;
                document.getElementById('incluir_descricao').checked = alunoInfo.incluir_descricao;
                document.getElementById('peso').value = alunoInfo.peso;
                document.getElementById('altura').value = alunoInfo.altura;
                document.getElementById('idade').value = alunoInfo.idade;
                document.getElementById('sexo').value = alunoInfo.sexo;
                document.getElementById('fator_atividade').value = alunoInfo.fator_atividade;

                appState.treinoSemanal = JSON.parse(JSON.stringify(treinoSemanal)); // Deep copy
                renderizarPreview(appState.treinoSemanal);
                mostrarTela('treinoPreview');
                showNotification(`Treino "${nomeSelecionado}" carregado com sucesso!`);
            } else {
                showNotification('Treino não encontrado.', 'error');
            }
        }

        function deletarTreinoSelecionado() {
            const selectElement = document.getElementById('treinosSalvosSelect');
            const nomeSelecionado = selectElement.value;

            if (!nomeSelecionado) {
                showNotification('Por favor, selecione um treino para excluir.', 'error');
                return;
            }

            showConfirm(
                `Tem certeza que deseja excluir o treino "${nomeSelecionado}"? Esta ação não pode ser desfeita.`,
                () => {
                    delete appState.treinosSalvos[nomeSelecionado];
                    localStorage.setItem('treinosSalvos', JSON.stringify(appState.treinosSalvos));
                    showNotification(`Treino "${nomeSelecionado}" excluído com sucesso!`);
                    carregarTreinosSalvos();
                }
            );
        }

        function renomearTreinoSelecionado() {
            const selectElement = document.getElementById('treinosSalvosSelect');
            const nomeAntigo = selectElement.value;

            if (!nomeAntigo) {
                showNotification('Por favor, selecione um treino para renomear.', 'error');
                return;
            }

            const nomeNovo = prompt("Digite o novo nome para o treino:", nomeAntigo);

            if (nomeNovo && nomeNovo.trim() !== "" && nomeNovo !== nomeAntigo) {
                if (appState.treinosSalvos[nomeNovo]) {
                    showNotification(`Já existe um treino com o nome "${nomeNovo}".`, 'error');
                    return;
                }
                
                appState.treinosSalvos[nomeNovo] = appState.treinosSalvos[nomeAntigo];
                delete appState.treinosSalvos[nomeAntigo];

                localStorage.setItem('treinosSalvos', JSON.stringify(appState.treinosSalvos));
                showNotification(`Treino renomeado para "${nomeNovo}" com sucesso!`);
                carregarTreinosSalvos();
            }
        }


        // --- Funções do PDF ---
        function gerarPdfTreinoSemanal(treino_semanal, dados_gerais, incluir_descricao, dados_nutricionais) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({ orientation: 'p', format: 'a4' });
            
            let y = 15;
            const margin = 15;
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();

            doc.setFontSize(26);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(30, 58, 95);
            doc.text("Plano de Treino Semanal", pageWidth / 2, y, { align: "center" });
            y += 12;
            
            doc.setFontSize(18);
            doc.setTextColor(51, 51, 51);
            doc.text(`Aluno: ${dados_gerais.nome_aluno}`, margin, y);
            y += 10;
            doc.setFontSize(16);
            doc.setFont("helvetica", "normal");
            doc.text(`Nível: ${dados_gerais.dificuldade} | Objetivo: ${dados_gerais.objetivo}`, margin, y);
            y += 10;
            doc.text(`Data de Criação: ${new Date().toLocaleDateString('pt-BR')}`, margin, y);
            y += 20;

            if (y > pageHeight - 50) {
                 doc.addPage();
                 y = 15;
            }
            doc.setFontSize(18);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(30, 58, 95);
            doc.text("Análise Nutricional", margin, y);
            doc.line(margin, y + 2, pageWidth - margin, y + 2);
            y += 8;
            doc.setFontSize(16);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(51, 51, 51);
            const imc_classificacao = getIMCClassificacao(dados_nutricionais.imc);
            doc.text(`IMC: ${dados_nutricionais.imc} (${imc_classificacao})`, margin, y);
            doc.text(`TMB: ${dados_nutricionais.tmb} kcal/dia`, margin, y + 8);
            doc.text(`Consumo Calórico Recomendado: ${dados_nutricionais.consumo} kcal/dia`, margin, y + 16);
            doc.text(`Peso Ideal: ${dados_nutricionais.pesoIdeal} kg`, margin, y + 24);
            doc.text(`Água Recomendada: ${dados_nutricionais.aguaRecomendada} ml/dia`, margin, y + 32);
            y += 40;
            
            if (y > pageHeight - 40) {
                doc.addPage();
                y = 15;
            }
            doc.setFontSize(18);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(30, 58, 95);
            doc.text("Aquecimento (5-10 minutos)", margin, y);
            doc.line(margin, y + 2, pageWidth - margin, y + 2);
            y += 8;
            doc.setFontSize(16);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(51, 51, 51);
            const aquecimentoText = "Inicie com 5 minutos de cardio leve (esteira, bicicleta) e depois faça alongamentos dinâmicos.";
            const aquecimentoLinhas = doc.splitTextToSize(aquecimentoText, pageWidth - margin * 2);
            doc.text(aquecimentoLinhas, margin, y);
            y += (aquecimentoLinhas.length * 8) + 12;
            
            treino_semanal.forEach(dia => {
                if (y > pageHeight - 60) {
                    doc.addPage();
                    y = 15;
                }

                doc.setFontSize(18);
                doc.setFont("helvetica", "bold");
                doc.setTextColor(30, 58, 95);
                doc.text(`Treino ${dia.nome_dia}`, margin, y);
                doc.line(margin, y + 2, pageWidth - margin, y + 2);
                y += 8;
                doc.setFontSize(16);
                doc.setFont("helvetica", "normal");
                doc.setTextColor(51, 51, 51);
                doc.text(`Grupos musculares: ${dia.grupos_musculares.join(', ')}`, margin, y);
                y += 10;

                const bodyData = [];
                let exercicioNum = 1;
                dia.treino.forEach((item) => {
                    const descanso = item.descanso || 'N/A';
                    const reps = getRepsParaNivel(item, dados_gerais.dificuldade);
                    
                    let obs = '';
                    if (item.tecnica) {
                        obs = `Técnica: ${item.tecnica}`;
                        if (item.observacaoTecnica) {
                            obs += `\n(${item.observacaoTecnica})`;
                        }
                    }

                    bodyData.push([exercicioNum++, item.nome, reps, descanso, obs]);
                    
                    if (item.supersetCom) {
                        const superex = item.supersetCom;
                        bodyData.push(['↳', superex.nome, superex.sugerirRepeticoes, '0s', '']);
                    } else if (item.preExaustaoCom) {
                        const preex = item.preExaustaoCom;
                        bodyData.push(['↳', preex.nome, preex.sugerirRepeticoes, '0s', '']);
                    }
                    
                    if (incluir_descricao) {
                        bodyData.push([{ content: `Descrição: ${item.descricao}`, colSpan: 5, styles: { fontSize: 10, fontStyle: 'italic' } }]);
                    }
                });

                doc.autoTable({
                    startY: y + 5,
                    head: [['#', 'Exercício', 'Séries/Reps', 'Descanso', 'Observações']],
                    body: bodyData,
                    theme: 'striped',
                    headStyles: { fillColor: [30, 58, 95], fontSize: 14 },
                    alternateRowStyles: { fillColor: [248, 250, 252] },
                    styles: { fontSize: 12, cellPadding: 3, overflow: 'linebreak' },
                    columnStyles: {
                        0: { cellWidth: 10 },
                        1: { cellWidth: 'auto' }, 
                        2: { cellWidth: 35 },
                        3: { cellWidth: 25 },
                        4: { cellWidth: 'auto' } 
                    }
                });
                
                y = doc.lastAutoTable.finalY + 10;
            });
            
            if (y > pageHeight - 100) {
                doc.addPage();
                y = 15;
            }
            
            doc.setFontSize(18);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(30, 58, 95);
            doc.text("Dicas para Maximizar seus Resultados", margin, y);
            doc.line(margin, y + 2, pageWidth - margin, y + 2);
            y += 10;
            
            const dicasPersonalizadas = gerarDicasPersonalizadas(dados_gerais.objetivo);
            const dicasBody = dicasPersonalizadas.map(dica => [dica.titulo, dica.texto]);

            doc.autoTable({
                startY: y,
                head: [['Tópico', 'Explicação']],
                body: dicasBody,
                theme: 'striped',
                headStyles: { fillColor: [30, 58, 95], fontSize: 14 },
                alternateRowStyles: { fillColor: [248, 250, 252] },
                styles: { fontSize: 12, cellPadding: 3, overflow: 'linebreak' },
                columnStyles: {
                    0: { cellWidth: 50 },
                    1: { cellWidth: 'auto' }
                }
            });
            
            y = doc.lastAutoTable.finalY + 10;

            const tecnicasAplicadasNesteTreino = new Set();
            treino_semanal.forEach(dia => {
                dia.treino.forEach(exercicio => {
                    if (exercicio.tecnica) {
                        tecnicasAplicadasNesteTreino.add(exercicio.tecnica);
                    }
                });
            });

            if (tecnicasAplicadasNesteTreino.size > 0) {
                if (y > pageHeight - (tecnicasAplicadasNesteTreino.size * 30 + 40)) {
                    doc.addPage();
                    y = 15;
                }

                doc.setFontSize(18);
                doc.setFont("helvetica", "bold");
                doc.setTextColor(30, 58, 95);
                doc.text("Entendendo as Técnicas Avançadas", margin, y);
                doc.line(margin, y + 2, pageWidth - margin, y + 2);
                y += 10;

                const tecnicasBody = [];
                tecnicasAplicadasNesteTreino.forEach(tecnica => {
                    if (DESCRICOES_TECNICAS[tecnica]) {
                        tecnicasBody.push([tecnica, DESCRICOES_TECNICAS[tecnica]]);
                    }
                });

                doc.autoTable({
                    startY: y,
                    head: [['Técnica', 'Descrição']],
                    body: tecnicasBody,
                    theme: 'striped',
                    headStyles: { fillColor: [30, 58, 95], fontSize: 14 },
                    alternateRowStyles: { fillColor: [248, 250, 252] },
                    styles: { fontSize: 12, cellPadding: 3, overflow: 'linebreak' },
                    columnStyles: {
                        0: { cellWidth: 50 },
                        1: { cellWidth: 'auto' } 
                    }
                });
                y = doc.lastAutoTable.finalY + 10;
            }
            
            doc.setFontSize(12);
            doc.setTextColor(150, 150, 150);
            doc.text(`Gerado por Your Trainer Partner para: ${dados_gerais.nome_aluno} em ${new Date().toLocaleDateString('pt-BR')}`, pageWidth / 2, doc.internal.pageSize.getHeight() - 10, { align: "center" });
            
            doc.save(`treino_semanal_${dados_gerais.nome_aluno}.pdf`);
        }
        
        // --- NOVAS FUNÇÕES DE CONTROLO DE TELA ---
        function mostrarTela(idTela) {
            document.getElementById('telaInicial').style.display = 'none';
            document.getElementById('treinoForm').style.display = 'none';
            document.getElementById('treinoPreview').style.display = 'none';
            document.getElementById('telaCarregar').style.display = 'none';

            document.getElementById(idTela).style.display = 'block';
        }

        function iniciarNovoTreino() {
            document.getElementById('treinoForm').reset();
            const diasContainer = document.getElementById('diasDeTreino');
            diasContainer.innerHTML = '<h2>Planilha de Treino</h2>';
            diaTreinoCount = 0;
            adicionarDiaTreino();
            mostrarTela('treinoForm');
        }

        function voltarParaEditarFormulario() {
            const diasContainer = document.getElementById('diasDeTreino');
            diasContainer.innerHTML = '<h2>Planilha de Treino</h2>';
            diaTreinoCount = 0;
            
            appState.treinoSemanal.forEach(dia => {
                adicionarDiaTreino();
                const ultimoDia = diasContainer.lastElementChild;
                ultimoDia.querySelector('input[name^="nome_dia_"]').value = dia.nome_dia;
                dia.grupos_musculares.forEach(grupo => {
                    const checkbox = ultimoDia.querySelector(`input[value="${grupo}"]`);
                    if (checkbox) checkbox.checked = true;
                });
                 dia.tecnicas_selecionadas.forEach(tecnica => {
                    const checkbox = ultimoDia.querySelector(`input[value="${tecnica}"]`);
                    if (checkbox) checkbox.checked = true;
                });
            });

            mostrarTela('treinoForm');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            setTimeout(() => {
                notification.className = `notification ${type}`;
            }, 3000);
        }

        function showConfirm(message, onConfirm) {
            const modal = document.getElementById('confirmModal');
            const messageEl = document.getElementById('confirmModalMessage');
            const btnOk = document.getElementById('confirmBtnOk');
            const btnCancel = document.getElementById('confirmBtnCancel');

            messageEl.textContent = message;
            modal.style.display = 'flex';

            btnOk.onclick = () => {
                onConfirm();
                fecharModal('confirmModal');
            };

            btnCancel.onclick = () => {
                fecharModal('confirmModal');
            };
        }


        window.onload = function() {
            const form = document.getElementById('treinoForm');
            form.addEventListener('submit', function(e) { e.preventDefault(); });
            carregarTreinosSalvos();
            mostrarTela('telaInicial');
        };
    </script>
</body>
</html>
